1695579630013:knitr::opts_chunk$set(echo = TRUE)
1695579630115:library(Seurat)
1695579633348:library(SeuratData)
1695579645120:library(SeuratDisk)
1695579645946:library(SingleCellExperiment)
1695579651192:library(Azimuth)
1695579651399:library(scran)
1695579652472:library(scater)
1695579652596:library(miloR)
1695579659243:if(!"bonemarrowref.SeuratData" %in% installed.packages()[,"Package"]){
1695579659248:install.packages("bonemarrowref.SeuratData_1.0.0.tar.gz",
1695579659250:repos = NULL, type = "source")
1695579659251:}
1695579681833:library(bonemarrowref.SeuratData)
1695580068080:library(bonemarrowref.SeuratData)
1695580073410:knitr::opts_chunk$set(echo = TRUE)
1695580073541:library(Seurat)
1695580073543:library(SeuratData)
1695580073544:library(SeuratDisk)
1695580073546:library(SingleCellExperiment)
1695580073552:library(Azimuth)
1695580073553:library(scran)
1695580073554:library(scater)
1695580073555:library(miloR)
1695580073564:data_dir <- c("HandsOn4_CellType_Analysis/")
1695580073568:setty_seurat <- LoadH5Seurat(paste0("HandsOn3_SingleCell_Data_QC/",
1695580073569:"processed_data/setty_seurat_clustered.h5seurat"))
1695580081609:library(Seurat)
1695580081615:library(SeuratData)
1695580081617:library(SeuratDisk)
1695580081619:library(SingleCellExperiment)
1695580081621:library(Azimuth)
1695580081623:library(scran)
1695580081624:library(scater)
1695580081625:library(miloR)
1695580093060:setty_seurat <- LoadH5Seurat(paste0("../HandsOn3_SingleCell_Data_QC/",
1695580093063:"processed_data/setty_seurat_clustered.h5seurat"))
1695580121197:available_data <- AvailableData()
1695580132192:available_data[grep("Azimuth", available_data[, 3]), 1:3]
1695580142271:if(!"bonemarrowref.SeuratData" %in% installed.packages()[,"Package"]){
1695580142276:install.packages("bonemarrowref.SeuratData_1.0.0.tar.gz",
1695580142278:repos = NULL, type = "source")
1695580142280:}
1695580142428:library(bonemarrowref.SeuratData)
1695580148946:DimPlot(setty_seurat, group.by = "predicted.celltype.l1",
1695580148949:reduction = "tsne", label = TRUE)
1695580265176:library(org.Hs.eg.db)
1695581566055:knitr::opts_chunk$set(echo = TRUE)
1695581566071:# Parent directories
1695581566072:inPath = "HandsOn5_A_Monocle3_Trajectory_Analysis/input_data/"
1695581566274:outPath = "HandsOn5_A_Monocle3_Trajectory_Analysis/output_data/"
1695581982729:# We will also make a few other empty directoires in the outpout folder
1695581982734:imgPath = paste(inPath, "images", sep = "/")
1695581987717:imgPath
1695581992576:# Parent directories
1695581992582:inPath = "HandsOn5_A_Monocle3_Trajectory_Analysis/input_data"
1695581992859:outPath = "HandsOn5_A_Monocle3_Trajectory_Analysis/output_data"
1695581996855:# We will also make a few other empty directoires in the outpout folder
1695581996861:imgPath = paste(inPath, "images", sep = "/")
1695581997925:imgPath
1695582050937:# Load seurat H5 using seurat function
1695582050943:sob = LoadH5Seurat(file = paste(inPath, "rep2_Processed_sob.h5seurat", sep = "/"),
1695582050946:verbose = F) # this will suppress all the verbose
1695582056533:inPath
1695582067900:"HandsOn5_A_Monocle3_Trajectory_Analysis/input_data/rep2_Processed_sob.h5seurat"
1695582094660:# Load seurat H5 using seurat function
1695582094666:sob = LoadH5Seurat(file = paste(inPath, "rep2_Processed_sob", sep = "/"),
1695582094669:verbose = F) # this will suppress all the verbose
1695582113369:# Load seurat H5 using seurat function
1695582113374:sob = LoadH5Seurat("input_data/rep2_Processed_sob.h5seurat"
1695582113377:#file = paste(inPath, "rep2_Processed_sob", sep = "/"),
1695582113380:verbose = F) # this will suppress all the verbose
1695582116844:# Load seurat H5 using seurat function
1695582116849:sob = LoadH5Seurat("input_data/rep2_Processed_sob.h5seurat",
1695582116851:#file = paste(inPath, "rep2_Processed_sob", sep = "/"),
1695582116852:verbose = F) # this will suppress all the verbose
1695582301910:getwd()
1695582449430:sob
1695582455616:# Checcking Data
1695582455622:DimPlot(sob)
1695582481286:# Load seurat H5 using seurat function
1695582481289:sob = LoadH5Seurat(file = paste(inPath, "setty_seurat_azimuth-classif.h5seurat", sep = "/"),
1695582481292:verbose = F) # this will suppress all the verbose
1695582486168:# Parent directories
1695582486174:inPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/input_data"
1695582486179:outPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/output_data"
1695582486186:# We will also make a few other empty directoires in the outpout folder
1695582486189:imgPath = paste(inPath, "images", sep = "/")
1695582486192:tabPath = paste(inPath, "tables", sep = "/")
1695582486194:rdsPath = paste(inPath, "rObjects", sep = "/")
1695582488851:# Load seurat H5 using seurat function
1695582488857:sob = LoadH5Seurat(file = paste(inPath, "setty_seurat_azimuth-classif.h5seurat", sep = "/"),
1695582488859:verbose = F) # this will suppress all the verbose
1695582514766:# Checcking Data
1695582514767:DimPlot(sob, )
1695582527527:sob
1695582564403:# Checcking Data
1695582564408:DimPlot(sob, group.by = "predicted.celltype.l2")
1695582577771:# Checcking Data
1695582577776:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "umap")
1695582583639:# Checcking Data
1695582583645:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne")
1695582771037:# Checcking Data
1695582771043:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582771046:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582771048:labs(xlab = "tSNE 1", ylab = "tSNE 2")
1695582796298:# Checcking Data
1695582796302:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582796303:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582796304:xlabs("tSNE 1") + ylab("tSNE 2")
1695582801180:# Checcking Data
1695582801182:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582801183:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582801183:xlab("tSNE 1") + ylab("tSNE 2")
1695582854058:# Checcking Data
1695582854064:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582854067:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582854069:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_manual("Dark2")
1695582862411:# Checcking Data
1695582862417:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582862420:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582862423:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer("Dark2")
1695582868386:# Checcking Data
1695582868391:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582868394:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582868396:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer("Set1")
1695582875520:?scale_color_brewer
1695582951337:# Checcking Data
1695582951340:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582951343:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582951345:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_viridis(discrete = TRUE, option = "D")
1695582977001:# Checcking Data
1695582977006:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582977009:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582977011:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_viridis_d(discrete = TRUE, option = "D")
1695582981793:# Checcking Data
1695582981799:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695582981803:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695582981805:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_viridis_d()
1695583049464:library(wesanderson)
1695583059613:install.packages("wesanderson")
1695583167689:wes_palette(name, n, type = c("discrete", "continuous"))
1695583171726:suppressPackageStartupMessages(library(wesanderson)) # For Coloring
1695583172868:wes_palette(name, n, type = c("discrete", "continuous"))
1695583194683:wes_palette("BottleRocket1", 12, type = c("discrete", "continuous"))
1695583207672:wes_palette("GrandBudapest2", 12, type = c("discrete", "continuous"))
1695583230310:# Checcking Data
1695583230316:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583230317:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583230319:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer()
1695583237693:# Checcking Data
1695583237698:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583237701:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583237702:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695583244672:# Checcking Data
1695583244676:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583244678:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583244679:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set11")
1695583248771:# Checcking Data
1695583248776:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583248778:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583248779:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set3")
1695583259515:# Checcking Data
1695583259522:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583259524:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583259526:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set4")
1695583266623:# Checcking Data
1695583266625:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583266626:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583266627:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set5")
1695583271842:# Checcking Data
1695583271848:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583271850:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583271851:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set2")
1695583299432:# Checcking Data
1695583299438:DimPlot(sob, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695583299441:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583299444:xlab("tSNE 1") + ylab("tSNE 2")
1695583357578:# Checcking Data
1695583357579:DimPlot(sob, group.by = "predicted.celltype.l1",reduction = "tsne", ) +
1695583357580:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583357581:xlab("tSNE 1") + ylab("tSNE 2")
1695583375513:# Checcking Data
1695583375519:DimPlot(sob, group.by = "predicted.celltype.l1",reduction = "tsne", ) +
1695583375522:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583375525:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer("Dark2")
1695583382598:# Checcking Data
1695583382604:DimPlot(sob, group.by = "predicted.celltype.l1",reduction = "tsne", ) +
1695583382608:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583382612:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer("set3")
1695583385942:# Checcking Data
1695583385948:DimPlot(sob, group.by = "predicted.celltype.l1",reduction = "tsne", ) +
1695583385949:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583385951:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer("Set3")
1695583395014:# Checcking Data
1695583395019:DimPlot(sob, group.by = "predicted.celltype.l1",reduction = "tsne", ) +
1695583395022:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583395026:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set3")
1695583403879:# Checcking Data
1695583403884:DimPlot(sob, group.by = "predicted.celltype.l1",reduction = "tsne", ) +
1695583403885:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695583403887:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695583781027:# Subset the dataset
1695583781030:sob.sub = subset(sob, subset = predicted.celltype.l1 == "HSPC")
1695583782378:# Print consoel
1695583782379:sob.sub
1695583787310:sib
1695583788848:sob
1695584589746:sob.sub@assays$prediction.score.celltype.l2
1695584609776:sob.sub@assays$RNA@data
1695584622689:sob.sub@assays$RNA@counts
1695584669267:rawCounts <- sob.sub@assays$RNA@counts
1695584686273:DT::datatable(rawCounts)
1695584707690:DT::datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]))
1695584762607:# View a few line of data
1695584762613:datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]))
1695584767002:suppressPackageStartupMessages(library(DT)) # Dynamic tables
1695584769205:# View a few line of data
1695584769211:datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]))
1695584876304:dim(rawCounts)
1695584899151:# Extract the Raw counts
1695584899158:cellMetaData <- sob.sub@meta.data
1695584907579:# View a few line of data
1695584907585:datatable(cellMetaData)
1695585010133:# Plot  of cell types
1695585010134:ggplot(cellMetaData, aes(x = "predicted.celltype.l2")) + geom_bar()
1695585020587:# Plot  of cell types
1695585020593:ggplot(cellMetaData, aes(y = "predicted.celltype.l2")) + geom_bar()
1695585031877:cellMetaData$predicted.celltype.l2
1695585121474:# Plot  of cell types
1695585121478:cellMetaData %>%
1695585121481:group_by(predicted.celltype.l1) %>%
1695585121485:summarise(count = n()) %>%
1695585121488:ggplot(aes(x=predicted.celltype.l1, y=count)) +
1695585121491:geom_bar(stat="identity", fill="blue") +
1695585121493:labs(x="Strings", y="Count", title="Counts of Strings in Dataframe") +
1695585121495:theme_minimal()
1695585141453:suppressPackageStartupMessages(library(tidyverse))
1695585144753:# Plot  of cell types
1695585144755:cellMetaData %>%
1695585144757:group_by(predicted.celltype.l1) %>%
1695585144759:summarise(count = n()) %>%
1695585144760:ggplot(aes(x=predicted.celltype.l1, y=count)) +
1695585144762:geom_bar(stat="identity", fill="blue") +
1695585144763:labs(x="Strings", y="Count", title="Counts of Strings in Dataframe") +
1695585144764:theme_minimal()
1695585154564:# Plot  of cell types
1695585154571:cellMetaData %>%
1695585154575:group_by(predicted.celltype.l2) %>%
1695585154579:summarise(count = n()) %>%
1695585154580:ggplot(aes(x=predicted.celltype.l2, y=count)) +
1695585154582:geom_bar(stat="identity", fill="blue") +
1695585154584:labs(x="Strings", y="Count", title="Counts of Strings in Dataframe") +
1695585154585:theme_minimal()
1695585205632:# Plot  of cell types
1695585205638:cellMetaData %>%
1695585205641:group_by(predicted.celltype.l2) %>%
1695585205644:summarise(count = n()) %>%
1695585205648:ggplot(aes(x=predicted.celltype.l2, y=count)) +
1695585205651:geom_bar(stat="identity") +
1695585205654:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585205656:theme_minimal()
1695585221742:# Plot  of cell types
1695585221748:cellMetaData %>%
1695585221751:group_by(predicted.celltype.l2) %>%
1695585221754:summarise(count = n()) %>%
1695585221756:ggplot(aes(x=predicted.celltype.l2, y=count)) +
1695585221757:geom_bar(stat="identity") + scale_color_brewer(palette = "set1")+
1695585221758:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585221759:theme_minimal()
1695585225620:# Plot  of cell types
1695585225626:cellMetaData %>%
1695585225628:group_by(predicted.celltype.l2) %>%
1695585225629:summarise(count = n()) %>%
1695585225630:ggplot(aes(x=predicted.celltype.l2, y=count)) +
1695585225632:geom_bar(stat="identity") + scale_color_brewer(palette = "Set1")+
1695585225633:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585225634:theme_minimal()
1695585271966:# Plot  of cell types
1695585271971:cellMetaData %>%
1695585271973:group_by(predicted.celltype.l2) %>%
1695585271974:summarise(count = n()) %>%
1695585271975:ggplot(aes(x=predicted.celltype.l2, y=count)) +
1695585271977:geom_bar(stat="identity") + scale_fill_brewer(palette = "Set1")+
1695585271978:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585271979:theme_minimal()
1695585283367:# Plot  of cell types
1695585283373:cellMetaData %>%
1695585283375:group_by(predicted.celltype.l2) %>%
1695585283377:summarise(count = n()) %>%
1695585283379:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585283380:geom_bar(stat="identity") + scale_fill_brewer(palette = "Set1")+
1695585283381:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585283383:theme_minimal()
1695585289922:# Plot  of cell types
1695585289928:cellMetaData %>%
1695585289931:group_by(predicted.celltype.l2) %>%
1695585289934:summarise(count = n()) %>%
1695585289937:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585289939:geom_bar(stat="identity") + scale_fill_brewer(palette = "Set3")+
1695585289941:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585289942:theme_minimal()
1695585299030:# Plot  of cell types
1695585299036:cellMetaData %>%
1695585299039:group_by(predicted.celltype.l2) %>%
1695585299040:summarise(count = n()) %>%
1695585299042:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585299043:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585299044:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585299045:theme_minimal()
1695585334798:# Plot  of cell types
1695585334804:cellMetaData %>%
1695585334807:group_by(predicted.celltype.l2) %>%
1695585334810:summarise(count = n()) %>%
1695585334814:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585334817:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585334820:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585334823:theme_minimal() + theme(axis.title.x = element_text(angle = 45, hjust = -1, vjust = 1))
1695585342030:# Plot  of cell types
1695585342034:cellMetaData %>%
1695585342036:group_by(predicted.celltype.l2) %>%
1695585342037:summarise(count = n()) %>%
1695585342038:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585342040:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585342041:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585342042:theme_minimal() + theme(axis.title.x = element_text(angle = 45, hjust = -1, vjust = 1))
1695585361783:# Plot  of cell types
1695585361790:cellMetaData %>%
1695585361793:group_by(predicted.celltype.l2) %>%
1695585361796:summarise(count = n()) %>%
1695585361798:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585361800:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585361801:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585361802:theme(axis.title.x = element_text(angle = 45, hjust = -1, vjust = 1))+ theme_minimal()
1695585367580:# Plot  of cell types
1695585367587:cellMetaData %>%
1695585367590:group_by(predicted.celltype.l2) %>%
1695585367592:summarise(count = n()) %>%
1695585367593:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585367594:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585367595:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585367597:theme(axis.title.x = element_text(angle = 45, hjust = 1, vjust = 1))+ theme_minimal()
1695585395268:# Plot  of cell types
1695585395269:cellMetaData %>%
1695585395271:group_by(predicted.celltype.l2) %>%
1695585395272:summarise(count = n()) %>%
1695585395273:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585395275:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585395276:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585395278:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))+ theme_minimal()
1695585435921:# Plot  of cell types
1695585435927:cellMetaData %>%
1695585435930:group_by(predicted.celltype.l2) %>%
1695585435934:summarise(count = n()) %>%
1695585435935:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585435938:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585435940:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585435941:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))+ theme_minimal()
1695585446895:cellMetaData %>%
1695585446899:group_by(predicted.celltype.l2) %>%
1695585446899:summarise(count = n()) %>%
1695585446899:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585446900:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585446900:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585446900:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))+ theme_minimal()
1695585482109:# Plot  of cell types
1695585482110:cellMetaData %>%
1695585482112:group_by(predicted.celltype.l2) %>%
1695585482114:summarise(count = n()) %>%
1695585482115:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585482117:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585482119:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585482120:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.5)) +
1695585482121:theme_minimal()
1695585488555:# Plot  of cell types
1695585488559:cellMetaData %>%
1695585488561:group_by(predicted.celltype.l2) %>%
1695585488562:summarise(count = n()) %>%
1695585488563:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585488565:geom_bar(stat="identity") + #scale_fill_brewer(palette = "Set3")+
1695585488566:labs(x="Cell Types", y="Number of Cells", title="Counts of annoated Cell types") +
1695585488567:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.5)) +
1695585488569:theme_minimal()
1695585796386:# View a few line of data
1695585796392:datatable(cellMetaData, options = list(scrollX = TRUE,
1695585796396:scroller = TRUE))
1695585841134:# Plot  of cell types
1695585841141:cellMetaData %>%
1695585841145:group_by(predicted.celltype.l2) %>%
1695585841149:summarise(count = n()) %>%
1695585841153:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585841156:geom_bar(stat="identity") +
1695585841159:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.5))
1695585848532:# Plot  of cell types
1695585848537:cellMetaData %>%
1695585848539:group_by(predicted.celltype.l2) %>%
1695585848540:summarise(count = n()) %>%
1695585848541:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585848543:geom_bar(stat="identity") +
1695585848544:theme(axis.text.x = element_text(angle = 45, hjust = -1, vjust = 0.5))
1695585853857:# Plot  of cell types
1695585853863:cellMetaData %>%
1695585853866:group_by(predicted.celltype.l2) %>%
1695585853868:summarise(count = n()) %>%
1695585853869:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585853871:geom_bar(stat="identity") +
1695585853872:theme(axis.text.x = element_text(angle = 45, hjust = -0.5, vjust = 0.5))
1695585860447:# Plot  of cell types
1695585860450:cellMetaData %>%
1695585860454:group_by(predicted.celltype.l2) %>%
1695585860457:summarise(count = n()) %>%
1695585860459:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585860461:geom_bar(stat="identity") +
1695585860462:theme(axis.text.x = element_text(angle = 45, hjust = 0, vjust = 0.5))
1695585865232:# Plot  of cell types
1695585865237:cellMetaData %>%
1695585865239:group_by(predicted.celltype.l2) %>%
1695585865240:summarise(count = n()) %>%
1695585865241:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585865242:geom_bar(stat="identity") +
1695585865243:theme(axis.text.x = element_text(angle = 45, hjust = 0, vjust = 0))
1695585871327:# Plot  of cell types
1695585871334:cellMetaData %>%
1695585871336:group_by(predicted.celltype.l2) %>%
1695585871337:summarise(count = n()) %>%
1695585871339:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585871340:geom_bar(stat="identity") +
1695585871341:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0))
1695585875496:# Plot  of cell types
1695585875502:cellMetaData %>%
1695585875506:group_by(predicted.celltype.l2) %>%
1695585875509:summarise(count = n()) %>%
1695585875511:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585875512:geom_bar(stat="identity") +
1695585875513:theme(axis.text.x = element_text(angle = 45, hjust = -1, vjust = 0))
1695585896115:# Plot  of cell types
1695585896118:cellMetaData %>%
1695585896121:group_by(predicted.celltype.l2) %>%
1695585896124:summarise(count = n()) %>%
1695585896127:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585896131:geom_bar(stat="identity") + theme_minimal()+
1695585896135:theme(axis.text.x = element_text(angle = 45, hjust = -1, vjust = 0))
1695585936263:# Plot  of cell types
1695585936267:cellMetaData %>%
1695585936269:group_by(predicted.celltype.l2) %>%
1695585936270:summarise(count = n()) %>%
1695585936271:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585936273:geom_bar(stat="identity") + theme_minimal()+
1695585936274:theme(axis.text.x = element_text(angle = 45, hjust = 0, vjust = 1))
1695585940576:# Plot  of cell types
1695585940583:cellMetaData %>%
1695585940585:group_by(predicted.celltype.l2) %>%
1695585940586:summarise(count = n()) %>%
1695585940587:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585940589:geom_bar(stat="identity") + theme_minimal()+
1695585940590:theme(axis.text.x = element_text(angle = 45, hjust = 0, vjust = -1))
1695585945665:# Plot  of cell types
1695585945669:cellMetaData %>%
1695585945671:group_by(predicted.celltype.l2) %>%
1695585945673:summarise(count = n()) %>%
1695585945674:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585945675:geom_bar(stat="identity") + theme_minimal()+
1695585945676:theme(axis.text.x = element_text(angle = 45, hjust = 0, vjust = -0.5))
1695585950609:# Plot  of cell types
1695585950611:cellMetaData %>%
1695585950612:group_by(predicted.celltype.l2) %>%
1695585950613:summarise(count = n()) %>%
1695585950614:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585950615:geom_bar(stat="identity") + theme_minimal()+
1695585950616:theme(axis.text.x = element_text(angle = 45, hjust = 0, vjust = -0))
1695585994848:# Plot  of cell types
1695585994853:cellMetaData %>%
1695585994856:group_by(predicted.celltype.l2) %>%
1695585994857:summarise(count = n()) %>%
1695585994858:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695585994860:geom_bar(stat="identity") + theme_minimal()+
1695585994863:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = -0))
1695586001609:# Plot  of cell types
1695586001610:cellMetaData %>%
1695586001611:group_by(predicted.celltype.l2) %>%
1695586001613:summarise(count = n()) %>%
1695586001616:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586001617:geom_bar(stat="identity") + theme_minimal()+
1695586001618:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 0.7))
1695586008676:# Plot  of cell types
1695586008682:cellMetaData %>%
1695586008685:group_by(predicted.celltype.l2) %>%
1695586008686:summarise(count = n()) %>%
1695586008687:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586008689:geom_bar(stat="identity") + theme_minimal()+
1695586008690:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))
1695586103520:# Plot  of cell types
1695586103524:cellMetaData %>%
1695586103526:group_by(predicted.celltype.l2) %>%
1695586103527:summarise(count = n()) %>%
1695586103529:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586103530:geom_bar(stat="identity") + theme_minimal()+
1695586103531:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586103533:geom_hline(yintercept = 50, linetype = "dashed", color = "blue")
1695586117813:# Plot  of cell types
1695586117816:cellMetaData %>%
1695586117818:group_by(predicted.celltype.l2) %>%
1695586117820:summarise(count = n()) %>%
1695586117821:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586117822:geom_bar(stat="identity") + theme_minimal()+
1695586117823:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586117824:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695586366498:# Plot  of cell types
1695586366504:sob.sub@meta.data %>%
1695586366508:group_by(predicted.celltype.l2) %>%
1695586366511:summarise(count = n()) %>%
1695586366514:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586366516:geom_bar(stat="identity") + theme_minimal()+
1695586366518:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586366519:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695586571234:# Subset the dataset
1695586571238:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", " Early Eryth", "EMP",
1695586571241:"GMP", "HSC", "LMPP", "preB"))
1695586594132:# Plot  of cell types
1695586594134:sob.sub.1@meta.data %>%
1695586594135:group_by(predicted.celltype.l2) %>%
1695586594137:summarise(count = n()) %>%
1695586594138:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586594139:geom_bar(stat="identity") + theme_minimal()+
1695586594140:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586594142:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695586642559:sob.sub@meta.data$predicted.celltype.l2
1695586650247:unique(sob.sub@meta.data$predicted.celltype.l2)
1695586666924:# Subset the dataset
1695586666930:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", " Early Eryth", "EMP",
1695586666932:"GMP", "HSC", "LMPP", "pre B"))
1695586668235:# Plot  of cell types
1695586668237:sob.sub.1@meta.data %>%
1695586668238:group_by(predicted.celltype.l2) %>%
1695586668239:summarise(count = n()) %>%
1695586668241:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586668242:geom_bar(stat="identity") + theme_minimal()+
1695586668243:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586668245:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695586684085:unique(sob.sub@meta.data$predicted.celltype.l2)
1695586713914:# Subset the dataset
1695586713919:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", " Early Eryth", "EMP",
1695586713921:"GMP", "HSC", "LMPP", "pre B"))
1695586715127:# Subset the dataset
1695586715129:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", " Early Eryth", "EMP",
1695586715130:"GMP", "HSC", "LMPP", "pre B"))
1695586717566:# Plot  of cell types
1695586717568:sob.sub.1@meta.data %>%
1695586717569:group_by(predicted.celltype.l2) %>%
1695586717570:summarise(count = n()) %>%
1695586717571:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586717573:geom_bar(stat="identity") + theme_minimal()+
1695586717574:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586717575:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695586726972:# Subset the dataset
1695586726979:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", "Early Eryth", "EMP",
1695586726981:"GMP", "HSC", "LMPP", "pre B"))
1695586728985:# Plot  of cell types
1695586728989:sob.sub.1@meta.data %>%
1695586728990:group_by(predicted.celltype.l2) %>%
1695586728991:summarise(count = n()) %>%
1695586728992:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586728993:geom_bar(stat="identity") + theme_minimal()+
1695586728995:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586728996:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695586775191:# Tsne
1695586775197:tsne_sub <- DimPlot(sob.sub.1, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695586775201:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695586775204:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695586779991:tsne_sub
1695586794528:# Plot  of cell types
1695586794532:bar_p <- sob.sub.1@meta.data %>%
1695586794536:group_by(predicted.celltype.l2) %>%
1695586794539:summarise(count = n()) %>%
1695586794542:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586794544:geom_bar(stat="identity") + theme_minimal()+scale_fill_brewer(palette = "Set1")
1695586799694:# Plot  of cell types
1695586799698:bar_p <- sob.sub.1@meta.data %>%
1695586799700:group_by(predicted.celltype.l2) %>%
1695586799702:summarise(count = n()) %>%
1695586799703:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695586799705:geom_bar(stat="identity") + theme_minimal()+scale_fill_brewer(palette = "Set1")+
1695586799706:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695586799708:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695586802522:bar_p
1695586815859:suppressPackageStartupMessages(library(ggpubr)) # Dynamic tables
1695586834243:# Let's view
1695586834256:ggarrange(tsne_sub, bar_p)
1695586864150:# Extract the Raw counts
1695586864163:rawCounts <- sob.sub@assays$RNA@counts
1695586864176:# View a few line of data
1695586864187:datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]),
1695586864197:options = list(scrollX = TRUE,
1695586864209:scroller = TRUE))
1695586868037:# Extract the Raw counts
1695586868050:cellMetaData <- sob.sub@meta.data
1695586868068:# View a few line of data
1695586868084:datatable(cellMetaData, options = list(scrollX = TRUE,
1695586868096:scroller = TRUE))
1695586874598:dim(rawCounts)
1695586881405:# Extract the Raw counts
1695586881418:rawCounts <- sob.sub.1@assays$RNA@counts
1695586882581:# View a few line of data
1695586882593:datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]),
1695586882605:options = list(scrollX = TRUE,
1695586882617:scroller = TRUE))
1695586886730:dim(rawCounts)
1695586894790:# Extract the Raw counts
1695586894804:cellMetaData <- sob.sub.1@meta.data
1695586895800:# View a few line of data
1695586895812:datatable(cellMetaData, options = list(scrollX = TRUE,
1695586895824:scroller = TRUE))
1695587240278:# Extract the Raw counts
1695587240290:cellMetaData <- sob.sub.1@meta.data
1695587240847:# Also adding complete names for the cell types
1695587240859:cellMetaData[cellMetaData$predicted.celltype.l2 == "HSC", "Cell.type"] = "Hematopoietic Stem Cells (HSCs)"
1695587241254:cellMetaData[cellMetaData$predicted.celltype.l2 == "CLP", "Cell.type"] = "Common Lymphoid Progenitor (CLPs)"
1695587241517:cellMetaData[cellMetaData$predicted.celltype.l2 == "Early Eryth", "Cell.type"] = "Primitive Erythrocytes (PEs)"
1695587241705:cellMetaData[cellMetaData$predicted.celltype.l2 == "EMP", "Cell.type"] = "Erythro-Myeloid Progenitors (EMPs)"
1695587241893:cellMetaData[cellMetaData$predicted.celltype.l2 == "Early Eryth", "Cell.type"] = "Primitive Erythrocytes (PEs)"
1695587242068:cellMetaData[cellMetaData$predicted.celltype.l2 == "GMP", "Cell.type"] = "Granulocyte-Monocyte Progenitor (GMPs)"
1695587242252:cellMetaData[cellMetaData$predicted.celltype.l2 == "LMPP", "Cell.type"] = "Lympho-Myeloid Primed Progenitor Cell (LMPPs)"
1695587242480:cellMetaData[cellMetaData$predicted.celltype.l2 == "pre B", "Cell.type"] = "Pre B Lymphocyte (Pre-B)"
1695587247110:# View a few line of data
1695587247121:datatable(cellMetaData, options = list(scrollX = TRUE,
1695587247133:scroller = TRUE))
1695587287196:cellMetaData %>%
1695587287209:group_by(Cell.type) %>%
1695587287221:summarise(count = n()) %>%
1695587287233:ggplot(aes(x=Cell.type, y=count, fill=Cell.type)) +
1695587287245:geom_bar(stat="identity") + theme_minimal()+scale_fill_brewer(palette = "Set1")+
1695587287257:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695587287269:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695587374581:sob.sub.1@assays$RNA@meta.features
1695587378481:View(sob.sub.1@assays$RNA@meta.features)
1695587403766:# The Gene level metadata is stored here
1695587403778:geneMetaData <- sob.sub.1@assays$RNA@meta.features
1695587592262:suppressPackageStartupMessages(library(org.Hs.eg.db)) # For annotations
1695587612521:geneMetaData
1695587615277:View(geneMetaData)
1695587621098:# map gene IDs to database
1695587621110:entrez_ids_ens <- mapIds(org.Hs.eg.db,
1695587621122:keys = rownames(geneMetaData),
1695587621133:column = "ENTREZID", keytype = "ENSEMBL")
1695587625044:entrez_ids_ens
1695587633740:entrez_ids_symb <- mapIds(org.Hs.eg.db,
1695587633756:keys = rownames(geneMetaData),
1695587633769:column = "ENTREZID", keytype = "SYMBOL")
1695587638096:# merge
1695587638111:entrez_ids_symb[is.na(entrez_ids_symb)] <- entrez_ids_ens[is.na(entrez_ids_symb)]
1695587641623:entrez_ids_symb
1695587645285:View(entrez_ids_symb)
1695587754458:# Create a function to map both ENSEMBL and SYMBOL
1695587754475:convert_to_ids_symbols <- function(gene) {
1695587754488:# Try converting assuming it's an ENSEMBL ID
1695587754500:symbol <- mapIds(org.Hs.eg.db, keys = gene, column = "SYMBOL", keytype = "ENSEMBL", multiVals = "first")
1695587754511:ensembl <- mapIds(org.Hs.eg.db, keys = gene, column = "ENSEMBL", keytype = "SYMBOL", multiVals = "first")
1695587754534:# Determine the type based on the result
1695587754545:if (!is.na(symbol)) {
1695587754555:return(c(ENSEMBL = gene, SYMBOL = symbol))
1695587754567:} else if (!is.na(ensembl)) {
1695587754578:return(c(ENSEMBL = ensembl, SYMBOL = gene))
1695587754589:} else {
1695587754599:return(c(ENSEMBL = NA, SYMBOL = NA))
1695587754610:}
1695587754621:}
1695587765880:# Apply the function to the row names of the Seurat object
1695587765892:gene_mapping <- t(sapply(rownames(geneMetaData), convert_to_ids_symbols))
1695587777153:rownames(geneMetaData)
1695587846583:# View the gene metadata
1695587846604:datatable(geneMetaData, options = list(scrollX = TRUE,
1695587846616:scroller = TRUE))
1695587863170:# Extract row names
1695587863189:genes <- rownames(geneMetaData)
1695587866152:# Split genes into potential ENSEMBL IDs and SYMBOLs based on pattern
1695587866164:ensembl_ids <- grep("^ENSG", genes, value = TRUE)
1695587866918:symbols <- setdiff(genes, ensembl_ids)
1695587868969:# Map ENSEMBL to SYMBOL
1695587868981:ensembl_to_symbol <- select(org.Hs.eg.db, keys = ensembl_ids, columns = "SYMBOL", keytype = "ENSEMBL")
1695587900614:# Map ENSEMBL to SYMBOL
1695587900627:ensembl_to_symbol <- AnnotationDbi::select(org.Hs.eg.db, keys = ensembl_ids, columns = "SYMBOL", keytype = "ENSEMBL")
1695587901675:colnames(ensembl_to_symbol) <- c("ENSEMBL", "SYMBOL")
1695587903933:# Map SYMBOL to ENSEMBL
1695587903944:symbol_to_ensembl <- select(org.Hs.eg.db, keys = symbols, columns = "ENSEMBL", keytype = "SYMBOL")
1695587907307:# Map SYMBOL to ENSEMBL
1695587907320:symbol_to_ensembl <- AnnotationDbi::select(org.Hs.eg.db, keys = symbols, columns = "ENSEMBL", keytype = "SYMBOL")
1695587908145:colnames(symbol_to_ensembl) <- c("SYMBOL", "ENSEMBL")
1695587909736:# Combine results and clean up
1695587909755:final_mapping <- bind_rows(
1695587909770:ensembl_to_symbol %>% select(ENSEMBL, SYMBOL),
1695587909783:symbol_to_ensembl %>% select(ENSEMBL, SYMBOL)
1695587909795:)
1695587911042:# View results
1695587911055:head(final_mapping)
1695587923859:View(final_mapping)
1695587964744:# Extract row names
1695587964758:geneMetaData$gene_short_name <- rownames(geneMetaData)
1695587979453:# View the gene metadata
1695587979466:datatable(geneMetaData, options = list(scrollX = TRUE,
1695587979479:scroller = TRUE))
1695588124411:# Using the Monocle3 native creation function
1695588124425:cds <- new_cell_data_set(expression_data = rawCounts,
1695588124436:cell_metadata = cellMetaData,
1695588124448:gene_metadata = geneMetaData)
1695588132890:suppressPackageStartupMessages(library(monocle3))
1695588136695:# Using the Monocle3 native creation function
1695588136708:cds <- new_cell_data_set(expression_data = rawCounts,
1695588136721:cell_metadata = cellMetaData,
1695588136733:gene_metadata = geneMetaData)
1695588138774:cds
1695588369719:?preprocess_cds()
1695588730567:# Monocle 3 allows do this to do pre-processing in 1 go
1695588730583:cds = preprocess_cds(cds = cds,
1695588730596:method = "PCA",
1695588730607:num_dim = 50,
1695588730619:norm_method = "log",
1695588730631:pseudo_count = 1,
1695588730643:scaling = T,
1695588730663:verbose = F)
1695588941185:?reduce_dimension
1695588995805:# Monocle 3 allows do this to do pre-processing in 1 go
1695588995818:cds = reduce_dimension(cds = cds,
1695588995830:max_components = 3,
1695588995843:reduction_method = "UMAP",
1695588995855:preprocess_method = "PCA",
1695588995866:umap.metric = 0.1,
1695588995877:umap.n_neighbors = 15L)
1695589006361:# Monocle 3 allows do this to do pre-processing in 1 go
1695589006374:cds = reduce_dimension(cds = cds,
1695589006386:max_components = 3,
1695589006397:reduction_method = "UMAP",
1695589006409:preprocess_method = "PCA",
1695589006421:umap.metric = 0.1,
1695589006432:umap.n_neighbors = 15)
1695589025009:# Monocle 3 allows do this to do pre-processing in 1 go
1695589025022:cds = reduce_dimension(cds = cds,
1695589025034:max_components = 3,
1695589025046:reduction_method = "UMAP",
1695589025057:umap.metric = 0.1,
1695589025069:umap.n_neighbors = 15)
1695589029626:# Monocle 3 allows do this to do pre-processing in 1 go
1695589029639:cds = reduce_dimension(cds = cds,
1695589029650:max_components = 2,
1695589029661:reduction_method = "UMAP",
1695589029672:umap.metric = 0.1,
1695589029683:umap.n_neighbors = 15)
1695589051957:# Monocle 3 allows do this to do pre-processing in 1 go
1695589051971:cds = reduce_dimension(cds = cds,
1695589051984:max_components = 3,
1695589051995:reduction_method = "UMAP",
1695589052007:preprocess_method = "PCA",
1695589052019:umap.min_dist = 0.1,
1695589052030:umap.n_neighbors = 15)
1695589207217:# Monocle 3 allows do this to do pre-processing in 1 go
1695589207230:umap_2d = plot_cells(cds = cds,
1695589207243:color_cells_by = "Cell.type",
1695589207254:show_trajectory_graph = F, # We will explore this later
1695589207265:label_cell_groups = F, # This is to hide labels on the map
1695589207275:cell_size = 1.5) + theme(legend.position = "bottom")
1695589210216:umap_2d
1695589264682:# 3d Plot
1695589264694:umap_2d = plot_cells_3d(cds = cds,
1695589264706:color_cells_by = "Cell.type",
1695589264717:show_trajectory_graph = F, # We will explore this later
1695589264729:label_cell_groups = F, # This is to hide labels on the map
1695589264740:cell_size = 1.5) + theme(legend.position = "bottom")
1695589268174:# 3d Plot
1695589268187:umap_3d = plot_cells_3d(cds = cds,
1695589268199:color_cells_by = "Cell.type",
1695589268211:show_trajectory_graph = F, # We will explore this later
1695589268222:label_cell_groups = F, # This is to hide labels on the map
1695589268233:cell_size = 1.5) + theme(legend.position = "bottom")
1695589270757:umap_3d
1695589281255:# 3d Plot
1695589281268:umap_3d = plot_cells_3d(cds = cds,
1695589281280:color_cells_by = "Cell.type",
1695589281292:show_trajectory_graph = F, # We will explore this later
1695589281303:cell_size = 1.5) + theme(legend.position = "bottom")
1695589283938:umap_3d
1695589290055:# 3d Plot
1695589290066:umap_3d = plot_cells_3d(cds = cds,
1695589290080:color_cells_by = "Cell.type",
1695589290092:show_trajectory_graph = F, # We will explore this later
1695589290103:cell_size = 1.5) + theme(legend.position = "bottom")
1695589296392:plot_cells_3d(cds = cds,
1695589296396:color_cells_by = "Cell.type",
1695589296397:show_trajectory_graph = F, # We will explore this later
1695589296397:cell_size = 1.5) + theme(legend.position = "bottom")
1695589303493:# 3d Plot
1695589303506:umap_3d = plot_cells_3d(cds = cds,
1695589303517:color_cells_by = "Cell.type",
1695589303530:show_trajectory_graph = F, # We will explore this later
1695589303542:cell_size = 1.5) + theme(legend.position = "bottom")
1695589308439:# 3d Plot
1695589308451:umap_3d <- plot_cells_3d(cds = cds,
1695589308463:color_cells_by = "Cell.type",
1695589308474:show_trajectory_graph = F, # We will explore this later
1695589308486:cell_size = 1.5) + theme(legend.position = "bottom")
1695589312371:umap_3d
1695589317016:# 3d Plot
1695589317030:umap_3d <- plot_cells_3d(cds = cds,
1695589317041:color_cells_by = "Cell.type",
1695589317053:show_trajectory_graph = F, # We will explore this later
1695589317064:cell_size = 1.5)
1695589321623:umap_3d
1695589328337:# 2D plot
1695589328351:umap_2d = plot_cells(cds = cds,
1695589328416:color_cells_by = "Cell.type",
1695589328428:show_trajectory_graph = F, # We will explore this later
1695589328440:label_cell_groups = F, # This is to hide labels on the map
1695589328452:cell_size = 1.5) + theme(legend.position = "bottom")
1695589329187:# 3d Plot
1695589329201:umap_3d <- plot_cells_3d(cds = cds,
1695589329219:color_cells_by = "Cell.type",
1695589329232:show_trajectory_graph = F, # We will explore this later
1695589329245:cell_size = 1.5)
1695589341166:ggarrange(umap_2d, umap_3d)
1695589375231:# 2D plot
1695589375243:plot_cells(cds = cds,
1695589375255:color_cells_by = "Cell.type",
1695589375267:show_trajectory_graph = F, # We will explore this later
1695589375279:label_cell_groups = F, # This is to hide labels on the map
1695589375290:cell_size = 1.5) + theme(legend.position = "bottom") +
1695589375301:scale_color_brewer(palette = "Set1")
1695589381537:plot_cells(cds = cds,
1695589381541:color_cells_by = "Cell.type",
1695589381543:show_trajectory_graph = F, # We will explore this later
1695589381543:label_cell_groups = F, # This is to hide labels on the map
1695589381544:cell_size = 1.5) + theme(legend.position = "bottom") +
1695589381545:scale_color_brewer(palette = "Set1")
1695589399421:# 2D plot
1695589399434:plot_cells(cds = cds,
1695589399447:color_cells_by = "Cell.type",alpha = 0.7,
1695589399459:show_trajectory_graph = F, # We will explore this later
1695589399470:label_cell_groups = F, # This is to hide labels on the map
1695589399483:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589399494:scale_color_brewer(palette = "Set1")
1695589402985:plot_cells(cds = cds,
1695589402989:color_cells_by = "Cell.type",alpha = 0.7,
1695589402989:show_trajectory_graph = F, # We will explore this later
1695589402989:label_cell_groups = F, # This is to hide labels on the map
1695589402990:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589402990:scale_color_brewer(palette = "Set1")
1695589419835:# 3d Plot
1695589419850:umap_3d <- plot_cells_3d(cds = cds,
1695589419862:color_cells_by = "Cell.type",
1695589419875:show_trajectory_graph = F, # We will explore this later
1695589419886:cell_size = 1.5)
1695589425385:# 3d Plot
1695589425398:umap_3d <- plot_cells_3d(cds = cds,
1695589425410:color_cells_by = "Cell.type",
1695589425422:show_trajectory_graph = F, # We will explore this later
1695589425434:cell_size = 3)
1695589431130:# 3d Plot
1695589431143:plot_cells_3d(cds = cds,
1695589431156:color_cells_by = "Cell.type",
1695589431168:show_trajectory_graph = F, # We will explore this later
1695589431180:cell_size = 3)
1695589536039:# Monocle 3 allows do this to do pre-processing in 1 go
1695589536053:cds = reduce_dimension(cds = cds,
1695589536066:max_components = 2,
1695589536077:reduction_method = "UMAP",
1695589536089:preprocess_method = "PCA",
1695589536101:umap.min_dist = 0.1,
1695589536112:umap.n_neighbors = 15)
1695589546405:# 2D plot
1695589546418:plot_cells(cds = cds,
1695589546430:color_cells_by = "Cell.type",alpha = 0.7,
1695589546442:show_trajectory_graph = F, # We will explore this later
1695589546453:label_cell_groups = F, # This is to hide labels on the map
1695589546464:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589546475:scale_color_brewer(palette = "Set1")
1695589561024:# Monocle 3 allows do this to do pre-processing in 1 go
1695589561038:cds = reduce_dimension(cds = cds,
1695589561051:max_components = 2,
1695589561063:reduction_method = "UMAP",
1695589561074:preprocess_method = "PCA",
1695589561086:umap.min_dist = 0.1,
1695589561098:umap.n_neighbors = 25)
1695589570571:# 2D plot
1695589570584:plot_cells(cds = cds,
1695589570595:color_cells_by = "Cell.type",alpha = 0.7,
1695589570605:show_trajectory_graph = F, # We will explore this later
1695589570616:label_cell_groups = F, # This is to hide labels on the map
1695589570628:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589570640:scale_color_brewer(palette = "Set1")
1695589582475:# Monocle 3 allows do this to do pre-processing in 1 go
1695589582509:cds = reduce_dimension(cds = cds,
1695589582530:max_components = 2,
1695589582541:reduction_method = "UMAP",
1695589582554:preprocess_method = "PCA",
1695589582566:umap.min_dist = 0.1,
1695589582579:umap.n_neighbors = 20)
1695589597796:# 2D plot
1695589597808:plot_cells(cds = cds,
1695589597821:color_cells_by = "Cell.type",alpha = 0.7,
1695589597833:show_trajectory_graph = F, # We will explore this later
1695589597844:label_cell_groups = F, # This is to hide labels on the map
1695589597857:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589597868:scale_color_brewer(palette = "Set1")
1695589722378:knitr::opts_chunk$set(echo = TRUE)
1695589722399:suppressPackageStartupMessages(library(SeuratDisk))
1695589722413:suppressPackageStartupMessages(library(Seurat))
1695589722425:suppressPackageStartupMessages(library(monocle3))
1695589722438:suppressPackageStartupMessages(library(tidyverse))
1695589722451:suppressPackageStartupMessages(library(ggplot2)) # For Plotting
1695589722472:suppressPackageStartupMessages(library(wesanderson)) # For Coloring
1695589722495:suppressPackageStartupMessages(library(DT)) # Dynamic tables
1695589722508:suppressPackageStartupMessages(library(ggpubr)) # Dynamic tables
1695589722535:suppressPackageStartupMessages(library(org.Hs.eg.db)) # For annotations
1695589722553:# Parent directories
1695589722567:inPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/input_data"
1695589722581:outPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/output_data"
1695589722597:# We will also make a few other empty directoires in the outpout folder
1695589722610:imgPath = paste(inPath, "images", sep = "/")
1695589722625:tabPath = paste(inPath, "tables", sep = "/")
1695589722688:rdsPath = paste(inPath, "rObjects", sep = "/")
1695589722709:# Load seurat H5 using seurat function
1695589722722:sob = LoadH5Seurat(file = paste(inPath, "setty_seurat_azimuth-classif.h5seurat", sep = "/"),
1695589722735:verbose = F) # this will suppress all the verbose
1695589748961:# Checcking Data
1695589748975:DimPlot(sob, group.by = "predicted.celltype.l1",reduction = "tsne", ) +
1695589748987:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695589748999:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695589749354:# Subset the dataset
1695589749368:sob.sub = subset(sob, subset = predicted.celltype.l1 == "HSPC")
1695589750538:# Print consoel
1695589750553:sob.sub
1695589750634:# Plot  of cell types
1695589750647:sob.sub@meta.data %>%
1695589750660:group_by(predicted.celltype.l2) %>%
1695589750673:summarise(count = n()) %>%
1695589750757:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695589750770:geom_bar(stat="identity") + theme_minimal()+
1695589750783:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695589750795:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695589751324:# Subset the dataset
1695589751339:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", "Early Eryth", "EMP",
1695589751352:"GMP", "HSC", "LMPP"))
1695589752460:# Plot  of cell types
1695589752475:bar_p = sob.sub.1@meta.data %>%
1695589752487:group_by(predicted.celltype.l2) %>%
1695589752499:summarise(count = n()) %>%
1695589752510:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695589752521:geom_bar(stat="identity") + theme_minimal()+scale_fill_brewer(palette = "Set1")+
1695589752533:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695589752546:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695589752856:# Tsne
1695589752860:tsne_sub = DimPlot(sob.sub.1, group.by = "predicted.celltype.l2",reduction = "tsne", ) +
1695589752862:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695589752865:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695589752976:# Let's view
1695589752979:ggarrange(tsne_sub, bar_p)
1695589753792:# Extract the Raw counts
1695589753809:rawCounts = sob.sub.1@assays$RNA@counts
1695589753832:# View a few line of data
1695589753850:datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]),
1695589753867:options = list(scrollX = TRUE,
1695589753885:scroller = TRUE))
1695589754017:# Extract the Raw counts
1695589754031:cellMetaData = sob.sub.1@meta.data
1695589754055:# Also adding complete names for the cell types
1695589754069:cellMetaData[cellMetaData$predicted.celltype.l2 == "HSC", "Cell.type"] = "Hematopoietic Stem Cells (HSCs)"
1695589754093:cellMetaData[cellMetaData$predicted.celltype.l2 == "CLP", "Cell.type"] = "Common Lymphoid Progenitor (CLPs)"
1695589754132:cellMetaData[cellMetaData$predicted.celltype.l2 == "Early Eryth", "Cell.type"] = "Primitive Erythrocytes (PEs)"
1695589754163:cellMetaData[cellMetaData$predicted.celltype.l2 == "EMP", "Cell.type"] = "Erythro-Myeloid Progenitors (EMPs)"
1695589754194:cellMetaData[cellMetaData$predicted.celltype.l2 == "Early Eryth", "Cell.type"] = "Primitive Erythrocytes (PEs)"
1695589754226:cellMetaData[cellMetaData$predicted.celltype.l2 == "GMP", "Cell.type"] = "Granulocyte-Monocyte Progenitor (GMPs)"
1695589754257:cellMetaData[cellMetaData$predicted.celltype.l2 == "LMPP", "Cell.type"] = "Lympho-Myeloid Primed Progenitor Cell (LMPPs)"
1695589754299:# View a few line of data
1695589754318:datatable(cellMetaData, options = list(scrollX = TRUE,
1695589754336:scroller = TRUE))
1695589754498:# The Gene level metadata is stored here
1695589754511:geneMetaData = sob.sub.1@assays$RNA@meta.features
1695589754527:# View the gene metadata
1695589754540:datatable(geneMetaData, options = list(scrollX = TRUE,
1695589754553:scroller = TRUE))
1695589756863:# Extract row names
1695589756895:geneMetaData$gene_short_name = rownames(geneMetaData)
1695589756912:# View the gene metadata
1695589756926:datatable(geneMetaData, options = list(scrollX = TRUE,
1695589756943:scroller = TRUE))
1695589757650:# Using the Monocle3 native creation function
1695589757677:cds = new_cell_data_set(expression_data = rawCounts,
1695589757706:cell_metadata = cellMetaData,
1695589757723:gene_metadata = geneMetaData)
1695589758210:cds
1695589758343:# Monocle 3 allows do this to do pre-processing in 1 go
1695589758357:cds = preprocess_cds(cds = cds,
1695589758371:method = "PCA",
1695589758385:num_dim = 50,
1695589758398:norm_method = "log",
1695589758412:pseudo_count = 1,
1695589758425:scaling = T,
1695589758439:verbose = F)
1695589781142:# Monocle 3 allows do this to do pre-processing in 1 go
1695589781162:cds = reduce_dimension(cds = cds,
1695589781178:max_components = 3,
1695589781193:reduction_method = "UMAP",
1695589781210:preprocess_method = "PCA",
1695589781226:umap.min_dist = 0.1,
1695589781241:umap.n_neighbors = 15)
1695589789714:# 2D plot
1695589789728:plot_cells(cds = cds,
1695589789741:color_cells_by = "Cell.type",alpha = 0.7,
1695589789753:show_trajectory_graph = F, # We will explore this later
1695589789766:label_cell_groups = F, # This is to hide labels on the map
1695589789779:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589789792:scale_color_brewer(palette = "Set1")
1695589790290:# 3d Plot
1695589790305:plot_cells_3d(cds = cds,
1695589790317:color_cells_by = "Cell.type",
1695589790328:show_trajectory_graph = F, # We will explore this later
1695589790340:cell_size = 3)
1695589819964:# Monocle 3 allows do this to do pre-processing in 1 go
1695589819977:cds = reduce_dimension(cds = cds,
1695589819990:max_components = 2,
1695589820002:reduction_method = "UMAP",
1695589820014:preprocess_method = "PCA",
1695589820025:umap.min_dist = 0.2,
1695589820038:umap.n_neighbors = 20)
1695589828442:# 2D plot
1695589828454:plot_cells(cds = cds,
1695589828466:color_cells_by = "Cell.type",alpha = 0.7,
1695589828477:show_trajectory_graph = F, # We will explore this later
1695589828489:label_cell_groups = F, # This is to hide labels on the map
1695589828501:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589828512:scale_color_brewer(palette = "Set1")
1695589843074:# Monocle 3 allows do this to do pre-processing in 1 go
1695589843087:cds = reduce_dimension(cds = cds,
1695589843100:max_components = 2,
1695589843113:reduction_method = "UMAP",
1695589843125:preprocess_method = "PCA",
1695589843136:umap.min_dist = 0.1,
1695589843148:umap.n_neighbors = 20)
1695589851786:# 2D plot
1695589851797:plot_cells(cds = cds,
1695589851808:color_cells_by = "Cell.type",alpha = 0.7,
1695589851819:show_trajectory_graph = F, # We will explore this later
1695589851832:label_cell_groups = F, # This is to hide labels on the map
1695589851843:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589851855:scale_color_brewer(palette = "Set1")
1695589865080:# Monocle 3 allows do this to do pre-processing in 1 go
1695589865093:cds = reduce_dimension(cds = cds,
1695589865105:max_components = 2,
1695589865118:reduction_method = "UMAP",
1695589865130:preprocess_method = "PCA",
1695589865141:umap.min_dist = 0.2,
1695589865151:umap.n_neighbors = 15)
1695589876356:# 2D plot
1695589876369:plot_cells(cds = cds,
1695589876382:color_cells_by = "Cell.type",alpha = 0.7,
1695589876394:show_trajectory_graph = F, # We will explore this later
1695589876405:label_cell_groups = F, # This is to hide labels on the map
1695589876416:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589876427:scale_color_brewer(palette = "Set1")
1695589907637:# Monocle 3 allows do this to do pre-processing in 1 go
1695589907652:cds = reduce_dimension(cds = cds,
1695589907665:max_components = 3,
1695589907677:reduction_method = "UMAP",
1695589907688:preprocess_method = "PCA",
1695589907701:umap.min_dist = 0.2,
1695589907721:umap.n_neighbors = 15)
1695589919781:# 2D plot
1695589919796:plot_cells(cds = cds,
1695589919809:color_cells_by = "Cell.type",alpha = 0.7,
1695589919821:show_trajectory_graph = F, # We will explore this later
1695589919833:label_cell_groups = F, # This is to hide labels on the map
1695589919845:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589919865:scale_color_brewer(palette = "Set1")
1695589920452:# 3d Plot
1695589920467:plot_cells_3d(cds = cds,
1695589920479:color_cells_by = "Cell.type",
1695589920490:show_trajectory_graph = F, # We will explore this later
1695589920503:cell_size = 3)
1695589949431:# 3d Plot
1695589949446:plot_cells_3d(cds = cds,
1695589949459:color_cells_by = "Cell.type",
1695589949469:show_trajectory_graph = F, # We will explore this later
1695589949480:cell_size = 5)
1695589960654:# 3d Plot
1695589960668:plot_cells_3d(cds = cds,
1695589960680:color_cells_by = "Cell.type",
1695589960691:show_trajectory_graph = F, # We will explore this later
1695589960702:cell_size = 10)
1695589979243:# Monocle 3 allows do this to do pre-processing in 1 go
1695589979256:cds = reduce_dimension(cds = cds,
1695589979269:max_components = 2,
1695589979280:reduction_method = "UMAP",
1695589979292:preprocess_method = "PCA",
1695589979303:umap.min_dist = 0.2,
1695589979316:umap.n_neighbors = 15)
1695589987532:# 2D plot
1695589987545:plot_cells(cds = cds,
1695589987557:color_cells_by = "Cell.type",alpha = 0.7,
1695589987571:show_trajectory_graph = F, # We will explore this later
1695589987584:label_cell_groups = F, # This is to hide labels on the map
1695589987597:cell_size = 1.4) + theme(legend.position = "bottom") +
1695589987609:scale_color_brewer(palette = "Set1")
1695627150394:knitr::opts_chunk$set(echo = TRUE)
1695627173874:knitr::opts_chunk$set(echo = TRUE)
1695627204227:knitr::opts_chunk$set(echo = TRUE)
1695627204236:suppressPackageStartupMessages(library(SeuratDisk))
1695627208049:suppressPackageStartupMessages(library(Seurat))
1695627208489:suppressPackageStartupMessages(library(monocle3))
1695627217397:suppressPackageStartupMessages(library(tidyverse))
1695627218058:suppressPackageStartupMessages(library(ggplot2)) # For plotting
1695627218059:suppressPackageStartupMessages(library(DT)) # For dynamic tables
1695627218083:suppressPackageStartupMessages(library(ggpubr)) # For additional plotting tools
1695627218167:# Parent directories
1695627218168:inPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/input_data"
1695627218169:outPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/output_data"
1695627218175:# We will also create a few other empty directories in the output folder
1695627218176:imgPath = paste(outPath, "images", sep = "/")
1695627218248:tabPath = paste(outPath, "tables", sep = "/")
1695627218251:rdsPath = paste(outPath, "rObjects", sep = "/")
1695627218258:# Load the Seurat H5 using the Seurat function
1695627218259:sob = LoadH5Seurat(file = paste(inPath, "setty_seurat_azimuth-classif.h5seurat", sep = "/"),
1695627218261:verbose = F) # This suppresses all verbose messages
1695627250114:# Checking Data
1695627250115:DimPlot(sob, group.by = "predicted.celltype.l1", reduction = "tsne") +
1695627250116:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695627250117:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695627250571:# Subset the dataset for HSPCs
1695627250572:sob.sub = subset(sob, subset = predicted.celltype.l1 == "HSPC")
1695627252860:# Print to console
1695627252862:print(sob.sub)
1695627252927:# Plotting the number of each cell type
1695627252929:sob.sub@meta.data %>%
1695627252931:group_by(predicted.celltype.l2) %>%
1695627252932:summarise(count = n()) %>%
1695627252934:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695627252935:geom_bar(stat="identity") + theme_minimal() +
1695627252942:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695627252944:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695627253541:# Subset the dataset based on specific cell types
1695627253543:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", "Early Eryth", "EMP",
1695627253544:"GMP", "HSC", "LMPP"))
1695627255553:# Generate a bar plot of the selected cell types
1695627255554:bar_p = sob.sub.1@meta.data %>%
1695627255555:group_by(predicted.celltype.l2) %>%
1695627255556:summarise(count = n()) %>%
1695627255557:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695627255559:geom_bar(stat="identity") + theme_minimal() + scale_fill_brewer(palette = "Set1") +
1695627255560:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695627255562:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695627255734:# tSNE plot of the subsetted cells
1695627255736:tsne_sub = DimPlot(sob.sub.1, group.by = "predicted.celltype.l2", reduction = "tsne") +
1695627255737:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695627255741:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695627255900:# Combine and display the tSNE and bar plots
1695627255902:ggarrange(tsne_sub, bar_p)
1695627256738:# Extracting the Raw counts
1695627256751:rawCounts = sob.sub.1@assays$RNA@counts
1695627256767:# Displaying a subset of the data for inspection
1695627256780:datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]),
1695627256794:options = list(scrollX = TRUE,
1695627256806:scroller = TRUE))
1695627257010:# Extracting the cell metadata
1695627257022:cellMetaData = sob.sub.1@meta.data
1695627257046:# Appending descriptive names for the cell types
1695627257059:cellMetaData[cellMetaData$predicted.celltype.l2 == "HSC", "Cell.type"] = "Hematopoietic Stem Cells (HSCs)"
1695627257083:cellMetaData[cellMetaData$predicted.celltype.l2 == "CLP", "Cell.type"] = "Common Lymphoid Progenitor (CLPs)"
1695627257106:cellMetaData[cellMetaData$predicted.celltype.l2 == "Early Eryth", "Cell.type"] = "Primitive Erythrocytes (PEs)"
1695627257129:cellMetaData[cellMetaData$predicted.celltype.l2 == "EMP", "Cell.type"] = "Erythro-Myeloid Progenitors (EMPs)"
1695627257152:cellMetaData[cellMetaData$predicted.celltype.l2 == "GMP", "Cell.type"] = "Granulocyte-Monocyte Progenitor (GMPs)"
1695627257178:cellMetaData[cellMetaData$predicted.celltype.l2 == "LMPP", "Cell.type"] = "Lympho-Myeloid Primed Progenitor Cell (LMPPs)"
1695627257205:# Displaying a subset of the metadata for inspection
1695627257219:datatable(cellMetaData, options = list(scrollX = TRUE,
1695627257233:scroller = TRUE))
1695627257376:# Extracting the gene-level metadata
1695627257391:geneMetaData = sob.sub.1@assays$RNA@meta.features
1695627257407:# Displaying a subset of the gene metadata for inspection
1695627257420:datatable(geneMetaData, options = list(scrollX = TRUE,
1695627257433:scroller = TRUE))
1695627257923:# Assigning row names to the gene_short_name column
1695627257945:geneMetaData$gene_short_name = rownames(geneMetaData)
1695627258132:# Displaying the updated gene metadata for verification
1695627258171:datatable(geneMetaData, options = list(scrollX = TRUE,
1695627258184:scroller = TRUE))
1695627258636:# Generating the CDS using Monocle3's built-in function
1695627258650:cds = new_cell_data_set(expression_data = rawCounts,
1695627258662:cell_metadata = cellMetaData,
1695627258674:gene_metadata = geneMetaData)
1695627259520:# Displaying the newly created CDS
1695627259537:cds
1695627259683:# Monocle 3 allows do this pre-processing in 1 go
1695627259699:cds = preprocess_cds(cds = cds,
1695627259714:method = "PCA",
1695627259727:num_dim = 50,
1695627259739:norm_method = "log",
1695627259754:pseudo_count = 1,
1695627259766:scaling = T,
1695627259778:verbose = F)
1695627345194:?reduce_dimension
1695627382803:# Monocle 3 allows do this to do pre-processing in 1 go
1695627382817:cds = reduce_dimension(cds = cds,
1695627382829:max_components = 3,
1695627382841:reduction_method = "UMAP",
1695627382853:preprocess_method = "PCA",
1695627382865:umap.min_dist = 0.2,
1695627382877:umap.n_neighbors = 15)
1695627389925:# We have other options as well
1695627389936:cds_tsne = reduce_dimension(cds = cds,
1695627389947:max_components = 3,
1695627389958:reduction_method = "tSNE",
1695627389969:preprocess_method = "PCA",
1695627389980:umap.min_dist = 0.2,
1695627389992:umap.n_neighbors = 15)
1695627405826:# We have other options as well
1695627405837:cds_PCA = reduce_dimension(cds = cds,
1695627405848:max_components = 3,
1695627405859:reduction_method = "PCA",
1695627405871:preprocess_method = "PCA",
1695627405882:umap.min_dist = 0.2,
1695627405893:umap.n_neighbors = 15)
1695627482175:# 2D plot PCA
1695627482187:cds_PCA_plot = plot_cells(cds = cds_PCA,
1695627482199:color_cells_by = "Cell.type",alpha = 0.7,
1695627482210:show_trajectory_graph = F, # We will explore this later
1695627482222:label_cell_groups = F, # This is to hide labels on the map
1695627482233:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627482243:scale_color_brewer(palette = "Set1")
1695627483131:# 2D plot tSNE
1695627483154:cds_tSNE_plot = plot_cells(cds = cds_tsne,
1695627483166:color_cells_by = "Cell.type",alpha = 0.7,
1695627483182:show_trajectory_graph = F, # We will explore this later
1695627483198:label_cell_groups = F, # This is to hide labels on the map
1695627483210:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627483223:scale_color_brewer(palette = "Set1")
1695627506824:# Plot
1695627506835:ggarrange(cds_tSNE_plot, cds_PCA_plot)
1695627535049:# Monocle 3 allows do this to do pre-processing in 1 go
1695627535062:cds = reduce_dimension(cds = cds,
1695627535075:max_components = 3,
1695627535087:reduction_method = "UMAP",
1695627535099:preprocess_method = "PCA",
1695627535111:umap.min_dist = 0.2,
1695627535122:umap.n_neighbors = 15)
1695627542668:# We have other options as well
1695627542680:cds_tsne = reduce_dimension(cds = cds,
1695627542691:max_components = 3,
1695627542702:reduction_method = "tSNE",
1695627542714:preprocess_method = "PCA",
1695627542727:umap.min_dist = 0.2,
1695627542740:umap.n_neighbors = 15)
1695627558869:# We have other options as well
1695627558880:cds_PCA = reduce_dimension(cds = cds,
1695627558893:max_components = 3,
1695627558905:reduction_method = "PCA",
1695627558919:preprocess_method = "PCA",
1695627558932:umap.min_dist = 0.2,
1695627558945:umap.n_neighbors = 15)
1695627560640:# 2D plot PCA
1695627560652:cds_PCA_plot = plot_cells(cds = cds_PCA, reduction_method = "PCA",
1695627560664:color_cells_by = "Cell.type",alpha = 0.7,
1695627560676:show_trajectory_graph = F, # We will explore this later
1695627560687:label_cell_groups = F, # This is to hide labels on the map
1695627560699:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627560712:scale_color_brewer(palette = "Set1")
1695627560964:# 2D plot tSNE
1695627560976:cds_tSNE_plot = plot_cells(cds = cds_tsne, reduction_method = "tSNE",
1695627560989:color_cells_by = "Cell.type",alpha = 0.7,
1695627561001:show_trajectory_graph = F, # We will explore this later
1695627561015:label_cell_groups = F, # This is to hide labels on the map
1695627561029:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627561042:scale_color_brewer(palette = "Set1")
1695627561298:# Plot
1695627561308:ggarrange(cds_tSNE_plot, cds_PCA_plot)
1695627585137:# 2D plot PCA
1695627585150:cds_PCA_plot = plot_cells(cds = cds_PCA, reduction_method = "PCA",
1695627585162:color_cells_by = "Cell.type",alpha = 0.7,
1695627585173:show_trajectory_graph = F, # We will explore this later
1695627585185:label_cell_groups = F, # This is to hide labels on the map
1695627585196:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627585207:scale_color_brewer(palette = "Set1")
1695627585437:# 2D plot tSNE
1695627585452:cds_tSNE_plot = plot_cells(cds = cds_tsne, reduction_method = "tSNE",
1695627585468:color_cells_by = "Cell.type",alpha = 0.7,
1695627585482:show_trajectory_graph = F, # We will explore this later
1695627585496:label_cell_groups = F, # This is to hide labels on the map
1695627585508:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627585525:scale_color_brewer(palette = "Set1")
1695627585799:# Plot
1695627585810:ggarrange(cds_tSNE_plot, cds_PCA_plot)
1695627592641:# 2D plot PCA
1695627592655:cds_PCA_plot = plot_cells(cds = cds_PCA, reduction_method = "PCA",
1695627592666:color_cells_by = "Cell.type",alpha = 0.7,
1695627592677:show_trajectory_graph = F, # We will explore this later
1695627592688:label_cell_groups = F, # This is to hide labels on the map
1695627592699:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627592711:scale_color_brewer(palette = "Set1")
1695627592927:# 2D plot tSNE
1695627592938:cds_tSNE_plot = plot_cells(cds = cds_tsne, reduction_method = "tSNE",
1695627592950:color_cells_by = "Cell.type",alpha = 0.7,
1695627592961:show_trajectory_graph = F, # We will explore this later
1695627592974:label_cell_groups = F, # This is to hide labels on the map
1695627592987:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627592999:scale_color_brewer(palette = "Set1")
1695627594164:# Plot
1695627594177:ggarrange(cds_tSNE_plot, cds_PCA_plot)
1695627616586:# 2D plot PCA
1695627616598:cds_PCA_plot = plot_cells(cds = cds_PCA, reduction_method = "PCA",
1695627616610:color_cells_by = "Cell.type",alpha = 0.7,
1695627616623:show_trajectory_graph = F, # We will explore this later
1695627616634:label_cell_groups = F, # This is to hide labels on the map
1695627616645:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627616655:scale_color_brewer(palette = "Set1")
1695627616919:# 2D plot tSNE
1695627616931:cds_tSNE_plot = plot_cells(cds = cds_tsne, reduction_method = "tSNE",
1695627616944:color_cells_by = "Cell.type",alpha = 0.7,
1695627616957:show_trajectory_graph = F, # We will explore this later
1695627616969:label_cell_groups = F, # This is to hide labels on the map
1695627616981:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627616994:scale_color_brewer(palette = "Set1")
1695627617221:# Plot
1695627617233:ggarrange(cds_tSNE_plot, cds_PCA_plot)
1695627627837:# 2D plot PCA
1695627627850:cds_PCA_plot = plot_cells(cds = cds_PCA, reduction_method = "PCA",
1695627627861:color_cells_by = "Cell.type",alpha = 0.7,
1695627627871:show_trajectory_graph = F, # We will explore this later
1695627627882:label_cell_groups = F, # This is to hide labels on the map
1695627627893:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627627903:scale_color_brewer(palette = "Set1")
1695627628118:# 2D plot tSNE
1695627628130:cds_tSNE_plot = plot_cells(cds = cds_tsne, reduction_method = "tSNE",
1695627628142:color_cells_by = "Cell.type",alpha = 0.7,
1695627628154:show_trajectory_graph = F, # We will explore this later
1695627628167:label_cell_groups = F, # This is to hide labels on the map
1695627628180:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627628193:scale_color_brewer(palette = "Set1")
1695627628429:# Plot
1695627628442:ggarrange(cds_tSNE_plot, cds_PCA_plot)
1695627651864:# 2D plot
1695627651887:plot_cells(cds = cds,
1695627651901:color_cells_by = "Cell.type",alpha = 0.7,
1695627651913:show_trajectory_graph = F, # We will explore this later
1695627651925:label_cell_groups = F, # This is to hide labels on the map
1695627651938:cell_size = 1.4) + theme(legend.position = "bottom") +
1695627651958:scale_color_brewer(palette = "Set1")
1695627652495:# 3d Plot
1695627652511:plot_cells_3d(cds = cds,
1695627652523:color_cells_by = "Cell.type",
1695627652534:show_trajectory_graph = F, # We will explore this later
1695627652545:cell_size = 10)
1695628060152:?cluster_cells
1695628097865:cds_louvain <- cluster_cells(cds = cds,
1695628097878:reduction_method = "UMAP",
1695628097890:cluster_method = "louvain")
1695628105029:cds <- cluster_cells(cds = cds,
1695628105041:reduction_method = "UMAP",
1695628105053:cluster_method = "leiden")
1695628107939:cds_louvain <- cluster_cells(cds = cds,
1695628107950:reduction_method = "UMAP",
1695628107961:cluster_method = "louvain")
1695628240714:# Lieden Clusters
1695628240731:lieden_Cluster <- plot_cells(cds = cds,
1695628240743:color_cells_by = "clusters",alpha = 0.7,
1695628240755:show_trajectory_graph = F, # We will explore this later
1695628240766:label_cell_groups = F, # This is to hide labels on the map
1695628240778:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628240790:scale_color_brewer(palette = "Set1")
1695628248190:# Lieden Clusters
1695628248202:lieden_Cluster <- plot_cells(cds = cds,
1695628248214:color_cells_by = "cluster",alpha = 0.7,
1695628248225:show_trajectory_graph = F, # We will explore this later
1695628248236:label_cell_groups = F, # This is to hide labels on the map
1695628248248:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628248259:scale_color_brewer(palette = "Set1")
1695628248485:# louvain Clusters
1695628248497:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628248510:color_cells_by = "cluster",alpha = 0.7,
1695628248523:show_trajectory_graph = F, # We will explore this later
1695628248536:label_cell_groups = F, # This is to hide labels on the map
1695628248547:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628248560:scale_color_brewer(palette = "Set1")
1695628248820:# Cell Types
1695628248831:cell_type_plots <- plot_cells(cds = cds,
1695628248841:color_cells_by = "Cell.type",alpha = 0.7,
1695628248853:show_trajectory_graph = F, # We will explore this later
1695628248863:label_cell_groups = F, # This is to hide labels on the map
1695628248875:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628248886:scale_color_brewer(palette = "Set1")
1695628310665:# Plot
1695628310677:ggarrange(lieden_Cluster, cell_type_plots, louvain_Cluster, ncol = 3,
1695628310688:labels = c("Lieden Clusters", "Azimuth Cell Types", "Louvain Clusters"))
1695628331406:# Lieden Clusters
1695628331420:lieden_Cluster <- plot_cells(cds = cds,
1695628331432:color_cells_by = "cluster",alpha = 0.7,
1695628331443:show_trajectory_graph = F, # We will explore this later
1695628331454:label_cell_groups = F, # This is to hide labels on the map
1695628331466:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628331477:scale_color_brewer(palette = "Set3")
1695628331705:# louvain Clusters
1695628331717:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628331730:color_cells_by = "cluster",alpha = 0.7,
1695628331744:show_trajectory_graph = F, # We will explore this later
1695628331758:label_cell_groups = F, # This is to hide labels on the map
1695628331771:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628331785:scale_color_brewer(palette = "Set3")
1695628332011:# Cell Types
1695628332025:cell_type_plots <- plot_cells(cds = cds,
1695628332038:color_cells_by = "Cell.type",alpha = 0.7,
1695628332049:show_trajectory_graph = F, # We will explore this later
1695628332061:label_cell_groups = F, # This is to hide labels on the map
1695628332116:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628332129:scale_color_brewer(palette = "Set3")
1695628332336:# Plot
1695628332348:ggarrange(lieden_Cluster, cell_type_plots, louvain_Cluster, ncol = 3,
1695628332359:labels = c("Lieden Clusters", "Azimuth Cell Types", "Louvain Clusters"))
1695628378214:cds <- cluster_cells(cds = cds,
1695628378226:reduction_method = "UMAP",
1695628378238:cluster_method = "leiden",
1695628378249:resolution = 0.01)
1695628381130:cds_louvain <- cluster_cells(cds = cds,
1695628381141:resolution = 0.01,
1695628381152:reduction_method = "UMAP",
1695628381163:cluster_method = "louvain")
1695628389242:# Lieden Clusters
1695628389254:lieden_Cluster <- plot_cells(cds = cds,
1695628389267:color_cells_by = "cluster",alpha = 0.7,
1695628389278:show_trajectory_graph = F, # We will explore this later
1695628389289:label_cell_groups = F, # This is to hide labels on the map
1695628389301:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628389313:scale_color_brewer(palette = "Set3")
1695628389534:# louvain Clusters
1695628389547:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628389561:color_cells_by = "cluster",alpha = 0.7,
1695628389573:show_trajectory_graph = F, # We will explore this later
1695628389586:label_cell_groups = F, # This is to hide labels on the map
1695628389599:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628389613:scale_color_brewer(palette = "Set3")
1695628389837:# Cell Types
1695628389850:cell_type_plots <- plot_cells(cds = cds,
1695628389862:color_cells_by = "Cell.type",alpha = 0.7,
1695628389875:show_trajectory_graph = F, # We will explore this later
1695628389887:label_cell_groups = F, # This is to hide labels on the map
1695628389898:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628389909:scale_color_brewer(palette = "Set3")
1695628390128:# Plot
1695628390141:ggarrange(lieden_Cluster, cell_type_plots, louvain_Cluster, ncol = 3,
1695628390154:labels = c("Lieden Clusters", "Azimuth Cell Types", "Louvain Clusters"))
1695628434637:cds <- cluster_cells(cds = cds,
1695628434649:reduction_method = "UMAP",
1695628434663:cluster_method = "leiden",
1695628434685:resolution = 0.01)
1695628437995:cds_louvain <- cluster_cells(cds = cds,
1695628438008:resolution = 0.01,
1695628438019:reduction_method = "UMAP",
1695628438031:cluster_method = "louvain")
1695628443718:# Lieden Clusters
1695628443730:lieden_Cluster <- plot_cells(cds = cds,
1695628443742:color_cells_by = "cluster",alpha = 0.7,
1695628443753:show_trajectory_graph = F, # We will explore this later
1695628443765:label_cell_groups = F, # This is to hide labels on the map
1695628443778:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628443790:scale_color_brewer(palette = "Set3")
1695628444022:# louvain Clusters
1695628444036:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628444051:color_cells_by = "cluster",alpha = 0.7,
1695628444064:show_trajectory_graph = F, # We will explore this later
1695628444077:label_cell_groups = F, # This is to hide labels on the map
1695628444090:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628444105:scale_color_brewer(palette = "Set3")
1695628444333:# Cell Types
1695628444346:cell_type_plots <- plot_cells(cds = cds,
1695628444358:color_cells_by = "Cell.type",alpha = 0.7,
1695628444371:show_trajectory_graph = F, # We will explore this later
1695628444384:label_cell_groups = F, # This is to hide labels on the map
1695628444395:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628444406:scale_color_brewer(palette = "Set3")
1695628444627:# Plot
1695628444640:ggarrange(lieden_Cluster, cell_type_plots, louvain_Cluster, ncol = 3,
1695628444653:labels = c("Lieden Clusters", "Azimuth Cell Types", "Louvain Clusters"))
1695628459862:# Lieden Clusters
1695628459874:lieden_Cluster <- plot_cells(cds = cds,
1695628459886:color_cells_by = "cluster",alpha = 0.7,
1695628459897:show_trajectory_graph = F, # We will explore this later
1695628459909:label_cell_groups = F, # This is to hide labels on the map
1695628459920:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628459931:scale_color_brewer(palette = "Set3")
1695628460150:# louvain Clusters
1695628460163:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628460175:color_cells_by = "cluster",alpha = 0.7,
1695628460187:show_trajectory_graph = F, # We will explore this later
1695628460200:label_cell_groups = F, # This is to hide labels on the map
1695628460212:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628460225:scale_color_brewer(palette = "Set3")
1695628460483:# Cell Types
1695628460497:cell_type_plots <- plot_cells(cds = cds,
1695628460512:color_cells_by = "Cell.type",alpha = 0.7,
1695628460524:show_trajectory_graph = F, # We will explore this later
1695628460536:label_cell_groups = F, # This is to hide labels on the map
1695628460548:cell_size = 1.4) + theme(legend.position = "left") +
1695628460560:scale_color_brewer(palette = "Set3")
1695628460779:# Plot
1695628460791:ggarrange(lieden_Cluster, cell_type_plots, louvain_Cluster, ncol = 3,
1695628460804:labels = c("Lieden Clusters", "Azimuth Cell Types", "Louvain Clusters"))
1695628508944:# Plot
1695628508957:ggarrange(lieden_Cluster, louvain_Cluster, cell_type_plots, ncol = 2, nrow = 2,
1695628508969:labels = c("Lieden Clusters", "Louvain Clusters", "Azimuth Cell Types"))
1695628514824:# Lieden Clusters
1695628514836:lieden_Cluster <- plot_cells(cds = cds,
1695628514848:color_cells_by = "cluster",alpha = 0.7,
1695628514859:show_trajectory_graph = F, # We will explore this later
1695628514870:label_cell_groups = F, # This is to hide labels on the map
1695628514880:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628514890:scale_color_brewer(palette = "Set3")
1695628515110:# louvain Clusters
1695628515123:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628515137:color_cells_by = "cluster",alpha = 0.7,
1695628515152:show_trajectory_graph = F, # We will explore this later
1695628515166:label_cell_groups = F, # This is to hide labels on the map
1695628515180:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628515194:scale_color_brewer(palette = "Set3")
1695628515428:# Cell Types
1695628515440:cell_type_plots <- plot_cells(cds = cds,
1695628515453:color_cells_by = "Cell.type",alpha = 0.7,
1695628515465:show_trajectory_graph = F, # We will explore this later
1695628515478:label_cell_groups = F, # This is to hide labels on the map
1695628515490:cell_size = 1.4) + theme(legend.position = "right") +
1695628515502:scale_color_brewer(palette = "Set3")
1695628515792:# Plot
1695628515805:ggarrange(lieden_Cluster, louvain_Cluster, cell_type_plots, ncol = 2, nrow = 2,
1695628515826:labels = c("Lieden Clusters", "Louvain Clusters", "Azimuth Cell Types"))
1695628531495:# Lieden Clusters
1695628531507:lieden_Cluster <- plot_cells(cds = cds,
1695628531519:color_cells_by = "cluster",alpha = 0.7,
1695628531530:show_trajectory_graph = F, # We will explore this later
1695628531542:label_cell_groups = F, # This is to hide labels on the map
1695628531552:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628531563:scale_color_brewer(palette = "Set3")
1695628531784:# louvain Clusters
1695628531797:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628531810:color_cells_by = "cluster",alpha = 0.7,
1695628531822:show_trajectory_graph = F, # We will explore this later
1695628531835:label_cell_groups = F, # This is to hide labels on the map
1695628531849:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628531863:scale_color_brewer(palette = "Set3")
1695628532087:# Cell Types
1695628532099:cell_type_plots <- plot_cells(cds = cds,
1695628532111:color_cells_by = "Cell.type",alpha = 0.7,
1695628532123:show_trajectory_graph = F, # We will explore this later
1695628532136:label_cell_groups = F, # This is to hide labels on the map
1695628532149:cell_size = 1.4) + theme(legend.position = "right") +
1695628532161:scale_color_brewer(palette = "Set3")
1695628532383:# Plot
1695628532396:ggarrange(lieden_Cluster, louvain_Cluster, cell_type_plots, ncol = 2, nrow = 2,
1695628532411:labels = c("Lieden Clusters", "Louvain Clusters", "Azimuth Cell Types"))
1695628597901:cds <- cluster_cells(cds = cds,
1695628597918:reduction_method = "UMAP",
1695628597932:cluster_method = "leiden",
1695628597946:resolution = 0.01,
1695628597959:k = 25)
1695628601770:cds_louvain <- cluster_cells(cds = cds,
1695628601782:k = 25,
1695628601794:resolution = 0.01,
1695628601805:reduction_method = "UMAP",
1695628601816:cluster_method = "louvain")
1695628613317:# Lieden Clusters
1695628613330:lieden_Cluster <- plot_cells(cds = cds,
1695628613342:color_cells_by = "cluster",alpha = 0.7,
1695628613355:show_trajectory_graph = F, # We will explore this later
1695628613367:label_cell_groups = F, # This is to hide labels on the map
1695628613378:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628613390:scale_color_brewer(palette = "Set3")
1695628613631:# louvain Clusters
1695628613648:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628613664:color_cells_by = "cluster",alpha = 0.7,
1695628613679:show_trajectory_graph = F, # We will explore this later
1695628613697:label_cell_groups = F, # This is to hide labels on the map
1695628613714:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628613728:scale_color_brewer(palette = "Set3")
1695628613968:# Cell Types
1695628613980:cell_type_plots <- plot_cells(cds = cds,
1695628613992:color_cells_by = "Cell.type",alpha = 0.7,
1695628614004:show_trajectory_graph = F, # We will explore this later
1695628614015:label_cell_groups = F, # This is to hide labels on the map
1695628614026:cell_size = 1.4) + theme(legend.position = "right") +
1695628614036:scale_color_brewer(palette = "Set3")
1695628614318:# Plot
1695628614331:ggarrange(lieden_Cluster, louvain_Cluster, cell_type_plots, ncol = 2, nrow = 2,
1695628614346:labels = c("Lieden Clusters", "Louvain Clusters", "Azimuth Cell Types"))
1695628630287:cds <- cluster_cells(cds = cds,
1695628630300:reduction_method = "UMAP",
1695628630312:cluster_method = "leiden",
1695628630324:#resolution = 0.01,
1695628630336:k = 25)
1695628633625:cds_louvain <- cluster_cells(cds = cds,
1695628633638:k = 25,
1695628633651:resolution = 0.01,
1695628633663:reduction_method = "UMAP",
1695628633675:cluster_method = "louvain")
1695628636845:# Lieden Clusters
1695628636858:lieden_Cluster <- plot_cells(cds = cds,
1695628636872:color_cells_by = "cluster",alpha = 0.7,
1695628636884:show_trajectory_graph = F, # We will explore this later
1695628636897:label_cell_groups = F, # This is to hide labels on the map
1695628636910:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628636922:scale_color_brewer(palette = "Set3")
1695628637164:# louvain Clusters
1695628637176:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628637188:color_cells_by = "cluster",alpha = 0.7,
1695628637200:show_trajectory_graph = F, # We will explore this later
1695628637212:label_cell_groups = F, # This is to hide labels on the map
1695628637224:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628637236:scale_color_brewer(palette = "Set3")
1695628637461:# Cell Types
1695628637473:cell_type_plots <- plot_cells(cds = cds,
1695628637486:color_cells_by = "Cell.type",alpha = 0.7,
1695628637499:show_trajectory_graph = F, # We will explore this later
1695628637512:label_cell_groups = F, # This is to hide labels on the map
1695628637523:cell_size = 1.4) + theme(legend.position = "right") +
1695628637535:scale_color_brewer(palette = "Set3")
1695628637748:# Plot
1695628637759:ggarrange(lieden_Cluster, louvain_Cluster, cell_type_plots, ncol = 2, nrow = 2,
1695628637771:labels = c("Lieden Clusters", "Louvain Clusters", "Azimuth Cell Types"))
1695628654813:cds <- cluster_cells(cds = cds,
1695628654826:reduction_method = "UMAP",
1695628654837:cluster_method = "leiden",
1695628654848:resolution = 0.01,
1695628654859:k = 25)
1695628658171:cds_louvain <- cluster_cells(cds = cds,
1695628658184:k = 25,
1695628658196:resolution = 0.01,
1695628658208:reduction_method = "UMAP",
1695628658221:cluster_method = "louvain")
1695628672355:# Lieden Clusters
1695628672367:lieden_Cluster <- plot_cells(cds = cds,
1695628672379:color_cells_by = "cluster",alpha = 0.7,
1695628672390:show_trajectory_graph = F, # We will explore this later
1695628672402:label_cell_groups = F, # This is to hide labels on the map
1695628672414:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628672435:scale_color_brewer(palette = "Set3")
1695628672669:# louvain Clusters
1695628672683:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628672698:color_cells_by = "cluster",alpha = 0.7,
1695628672713:show_trajectory_graph = F, # We will explore this later
1695628672727:label_cell_groups = F, # This is to hide labels on the map
1695628672743:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628672758:scale_color_brewer(palette = "Set1")
1695628673021:# Cell Types
1695628673032:cell_type_plots <- plot_cells(cds = cds,
1695628673044:color_cells_by = "Cell.type",alpha = 0.7,
1695628673056:show_trajectory_graph = F, # We will explore this later
1695628673068:label_cell_groups = F, # This is to hide labels on the map
1695628673080:cell_size = 1.4) + theme(legend.position = "right") +
1695628673092:scale_color_brewer(palette = "Set1")
1695628673333:# Plot
1695628673347:ggarrange(lieden_Cluster, louvain_Cluster, cell_type_plots, ncol = 2, nrow = 2,
1695628673362:labels = c("Lieden Clusters", "Louvain Clusters", "Azimuth Cell Types"))
1695628701506:# Plot
1695628701518:lieden_Cluster + cell_type_plots
1695628735689:# Plot
1695628735701:ggarrange(a, b, cell_type_plots, ncol = 1, nrow = 2)
1695628737389:# Plot
1695628737401:a <- lieden_Cluster + cell_type_plots
1695628737692:b <- louvain_Cluster + cell_type_plots
1695628738091:# Plot
1695628738098:ggarrange(a, b, cell_type_plots, ncol = 1, nrow = 2)
1695628780326:# Lieden Clusters
1695628780330:lieden_Cluster <- plot_cells(cds = cds,
1695628780334:color_cells_by = "cluster",alpha = 0.7,
1695628780337:show_trajectory_graph = F, # We will explore this later
1695628780340:label_cell_groups = F, # This is to hide labels on the map
1695628780343:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628780346:scale_color_brewer(palette = "Set3")
1695628780595:# louvain Clusters
1695628780598:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695628780601:color_cells_by = "cluster",alpha = 0.7,
1695628780605:show_trajectory_graph = F, # We will explore this later
1695628780608:label_cell_groups = F, # This is to hide labels on the map
1695628780612:cell_size = 1.4) + theme(legend.position = "bottom") +
1695628780615:scale_color_brewer(palette = "Set1")
1695628780861:# Cell Types
1695628780864:cell_type_plots <- plot_cells(cds = cds,
1695628780867:color_cells_by = "Cell.type",alpha = 0.7,
1695628780870:show_trajectory_graph = F, # We will explore this later
1695628780873:label_cell_groups = F, # This is to hide labels on the map
1695628780876:cell_size = 1.4) + theme(legend.position = "right") +
1695628780879:scale_color_brewer(palette = "Set1")
1695628781115:# Plot lieden_Cluster
1695628781118:lieden_Cluster + cell_type_plots
1695628781792:# Plot louvain_Cluster
1695628781799:louvain_Cluster + cell_type_plots
1695629112239:partition_plots <- plot_cells(cds = cds,
1695629112246:color_cells_by = "partition",alpha = 0.7,
1695629112250:show_trajectory_graph = F, # We will explore this later
1695629112253:label_cell_groups = F, # This is to hide labels on the map
1695629112256:cell_size = 1.4) + theme(legend.position = "right") +
1695629112258:scale_color_brewer(palette = "Set1")
1695629127564:partition_plots
1695629663020:cds <- learn_graph(cds = cds,
1695629663029:use_partition = F, # We will see it later
1695629663033:close_loop = F)  # We will see it later
1695631234703:# Set colour label as partition
1695631234708:trajectory_plots <- plot_cells(cds = cds,
1695631234712:color_cells_by = "partition",alpha = 0.7,
1695631234715:show_trajectory_graph = T, # We will explore this later
1695631234719:label_cell_groups = F, # This is to hide labels on the map
1695631234722:cell_size = 0.1) + theme(legend.position = "right") +
1695631234725:scale_color_brewer(palette = "Set1")
1695631239804:trajectory_plots
1695631281216:# Set colour label as partition
1695631281224:trajectory_plots <- plot_cells(cds = cds,
1695631281228:color_cells_by = "partition",alpha = 0.7,
1695631281230:show_trajectory_graph = T, # We will explore this later
1695631281233:label_cell_groups = F, # This is to hide labels on the map
1695631281236:cell_size = 0.1) +
1695631281239:scale_color_brewer(palette = "Set1")
1695631339660:# Label principal Points
1695631339663:ppoints_plots <- plot_cells(cds = cds,
1695631339666:label_branch_points = T,
1695631339669:label_principal_points = T,
1695631339672:color_cells_by = "partition",alpha = 0.7,
1695631339675:show_trajectory_graph = T, # We will explore this later
1695631339677:label_cell_groups = F, # This is to hide labels on the map
1695631339680:cell_size = 0.1) +
1695631339683:scale_color_brewer(palette = "Set1")
1695631342648:ppoints_plots
1695631423695:# Set show_trajectory_graph as true
1695631423703:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631423706:color_cells_by = "Cell.type",alpha = 0.7,
1695631423709:show_trajectory_graph = T, # We will explore this later
1695631423712:label_cell_groups = F, # This is to hide labels on the map
1695631423715:cell_size = 0.1) +
1695631423718:scale_color_brewer(palette = "Set1")
1695631462168:# Set show_trajectory_graph as true
1695631462173:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631462176:color_cells_by = "Cell.type",alpha = 0.7,
1695631462179:show_trajectory_graph = T, # We will explore this later
1695631462181:label_cell_groups = T, graph_label_size = 2,
1695631462184:cell_size = 0.1) +
1695631462187:scale_color_brewer(palette = "Set1")
1695631465382:trajectory_cellType_plots
1695631472554:# Set show_trajectory_graph as true
1695631472562:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631472569:color_cells_by = "Cell.type",alpha = 0.7,
1695631472580:show_trajectory_graph = T, # We will explore this later
1695631472588:label_cell_groups = T, graph_label_size = 2,
1695631472605:cell_size = 0.5) +
1695631472614:scale_color_brewer(palette = "Set1")
1695631475394:trajectory_cellType_plots
1695631479710:# Set show_trajectory_graph as true
1695631479714:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631479717:color_cells_by = "Cell.type",alpha = 0.7,
1695631479720:show_trajectory_graph = F, # We will explore this later
1695631479722:label_cell_groups = T, graph_label_size = 2,
1695631479725:cell_size = 0.5) +
1695631479727:scale_color_brewer(palette = "Set1")
1695631482241:# Set show_trajectory_graph as true
1695631482245:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631482248:color_cells_by = "Cell.type",alpha = 0.7,
1695631482251:show_trajectory_graph = F, # We will explore this later
1695631482253:label_cell_groups = T, graph_label_size = 2,
1695631482256:cell_size = 0.5) +
1695631482258:scale_color_brewer(palette = "Set3")
1695631485583:trajectory_cellType_plots
1695631499573:# Set show_trajectory_graph as true
1695631499579:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631499582:color_cells_by = "Cell.type",alpha = 0.7,
1695631499585:label_principal_points = F,
1695631499588:show_trajectory_graph = T, # We will explore this later
1695631499591:label_cell_groups = T, graph_label_size = 2,
1695631499593:cell_size = 0.5) +
1695631499596:scale_color_brewer(palette = "Set3")
1695631502571:trajectory_cellType_plots
1695631510153:# Set show_trajectory_graph as true
1695631510162:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631510217:color_cells_by = "Cell.type",alpha = 0.7,
1695631510223:label_principal_points = F,
1695631510228:show_trajectory_graph = T, # We will explore this later
1695631510232:label_cell_groups = T, graph_label_size = 10,
1695631510236:cell_size = 0.5) +
1695631510240:scale_color_brewer(palette = "Set3")
1695631513702:trajectory_cellType_plots
1695631521328:# Set show_trajectory_graph as true
1695631521333:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631521336:color_cells_by = "Cell.type",alpha = 0.7,
1695631521339:label_principal_points = F,
1695631521341:show_trajectory_graph = T, # We will explore this later
1695631521344:label_cell_groups = T, graph_label_size = 0.1,
1695631521346:cell_size = 0.5) +
1695631521349:scale_color_brewer(palette = "Set3")
1695631541532:# Set show_trajectory_graph as true
1695631541535:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631541538:color_cells_by = "Cell.type",alpha = 0.7,
1695631541541:label_principal_points = F,
1695631541543:show_trajectory_graph = T, # We will explore this later
1695631541547:label_cell_groups = T, graph_label_size = 0.1,
1695631541549:cell_size = 0.5) +
1695631541552:scale_color_brewer(palette = "Set3")
1695631544342:trajectory_cellType_plots
1695631613066:ggarrange(trajectory_plots, ppoints_plots, cell_type_plots, trajectory_cellType_plots,
1695631613071:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695631613074:"C. Cell Types", "D. Cell Types with Trajectory Graph"))
1695631620975:ggarrange(trajectory_plots, ppoints_plots, cell_type_plots, trajectory_cellType_plots,
1695631620979:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695631620979:"C. Cell Types", "D. Cell Types with Trajectory Graph"))
1695631683175:ggarrange(trajectory_plots, ppoints_plots, lieden_Cluster, trajectory_cellType_plots,
1695631683179:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695631683180:"C. Lieden Clusters", "D. Cell Types with Trajectory Graph"))
1695631704990:# Set show_trajectory_graph as true
1695631704996:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631704999:color_cells_by = "Cell.type",alpha = 0.7,
1695631705002:label_principal_points = F,
1695631705005:show_trajectory_graph = T, # We will explore this later
1695631705007:label_cell_groups = T, graph_label_size = 0.1,
1695631705010:cell_size = 0.5) +
1695631705013:scale_color_brewer(palette = "Set1")
1695631706324:ggarrange(trajectory_plots, ppoints_plots, lieden_Cluster, trajectory_cellType_plots,
1695631706328:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695631706331:"C. Lieden Clusters", "D. Cell Types with Trajectory Graph"))
1695631719327:# Set show_trajectory_graph as true
1695631719335:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631719341:color_cells_by = "Cell.type",alpha = 0.7,
1695631719347:label_principal_points = F,
1695631719350:show_trajectory_graph = T, # We will explore this later
1695631719353:label_cell_groups = T, graph_label_size = 0.1,
1695631719355:cell_size = 0.5) +
1695631719357:scale_color_brewer(palette = "Set3")
1695631721292:ggarrange(trajectory_plots, ppoints_plots, lieden_Cluster, trajectory_cellType_plots,
1695631721296:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695631721299:"C. Lieden Clusters", "D. Cell Types with Trajectory Graph"))
1695631779057:# Set show_trajectory_graph as true
1695631779062:trajectory_plots <- plot_cells(cds = cds,
1695631779066:color_cells_by = "partition",alpha = 0.7,
1695631779069:show_trajectory_graph = T, # We will explore this later
1695631779072:label_cell_groups = F, # This is to hide labels on the map
1695631779075:cell_size = 0.1) +
1695631779078:scale_color_brewer(palette = "Set1")
1695631779426:# Label principal Points
1695631779429:ppoints_plots <- plot_cells(cds = cds,
1695631779433:label_branch_points = T,
1695631779436:label_principal_points = T,
1695631779439:color_cells_by = "partition",alpha = 0.7,
1695631779443:show_trajectory_graph = T, # We will explore this later
1695631779446:label_cell_groups = F, # This is to hide labels on the map
1695631779449:cell_size = 0.1) +
1695631779453:scale_color_brewer(palette = "Set1")
1695631779765:# Set show_trajectory_graph as true
1695631779768:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631779771:color_cells_by = "Cell.type",alpha = 0.7,
1695631779773:label_principal_points = F,
1695631779776:show_trajectory_graph = T, # We will explore this later
1695631779779:label_cell_groups = T, graph_label_size = 0.1,
1695631779782:cell_size = 0.5) +
1695631779785:scale_color_brewer(palette = "Set3")
1695631780273:# Plot all together
1695631780276:ggarrange(trajectory_plots, ppoints_plots, lieden_Cluster, trajectory_cellType_plots,
1695631780280:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695631780284:"C. Lieden Clusters", "D. Cell Types with Trajectory Graph"))
1695631809984:# Set show_trajectory_graph as true
1695631809989:trajectory_plots <- plot_cells(cds = cds,
1695631809993:color_cells_by = "partition",alpha = 0.7,
1695631809996:show_trajectory_graph = T, # We will explore this later
1695631809999:label_cell_groups = F, # This is to hide labels on the map
1695631810002:cell_size = 0.1) +
1695631810005:scale_color_brewer(palette = "Set1")
1695631810370:# Label principal Points
1695631810373:ppoints_plots <- plot_cells(cds = cds,
1695631810377:label_branch_points = T,
1695631810380:label_principal_points = T,
1695631810384:color_cells_by = "partition",alpha = 0.7,
1695631810388:show_trajectory_graph = T, # We will explore this later
1695631810392:label_cell_groups = F, # This is to hide labels on the map
1695631810396:cell_size = 0.1) +
1695631810400:scale_color_brewer(palette = "Set1")
1695631810712:# Set show_trajectory_graph as true
1695631810716:trajectory_cellType_plots <- plot_cells(cds = cds,
1695631810720:color_cells_by = "Cell.type",alpha = 0.7,
1695631810723:label_principal_points = F,
1695631810726:show_trajectory_graph = T, # We will explore this later
1695631810729:label_cell_groups = T, graph_label_size = 0.1,
1695631810732:cell_size = 0.5) +
1695631810734:scale_color_brewer(palette = "Set3")
1695631811212:# Plot all together
1695631811215:ggarrange(trajectory_plots, ppoints_plots, lieden_Cluster, trajectory_cellType_plots,
1695631811218:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695631811221:"C. Lieden Clusters", "D. Cell Types with Trajectory Graph"))
1695632215047:# The following command launches the shinyApp
1695632215052:cds_shiny <- order_cells(cds = cds)
1695632243772:cds_shiny
1695632253676:# The following command launches the shinyApp
1695632253682:cds_shiny <- order_cells(cds = cds, reduction_method = "UMAP")
1695632286240:knitr::opts_chunk$set(echo = TRUE)
1695632286266:suppressPackageStartupMessages(library(SeuratDisk))
1695632286271:suppressPackageStartupMessages(library(Seurat))
1695632286276:suppressPackageStartupMessages(library(monocle3))
1695632286281:suppressPackageStartupMessages(library(tidyverse))
1695632286286:suppressPackageStartupMessages(library(ggplot2)) # For plotting
1695632286290:suppressPackageStartupMessages(library(DT)) # For dynamic tables
1695632286293:suppressPackageStartupMessages(library(ggpubr)) # For additional plotting tools
1695632286301:# Parent directories
1695632286305:inPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/input_data"
1695632286310:outPath = "/home/esr/HandsOn5_A_Monocle3_Trajectory_Analysis/output_data"
1695632286315:# We will also create a few other empty directories in the output folder
1695632286326:imgPath = paste(outPath, "images", sep = "/")
1695632286331:tabPath = paste(outPath, "tables", sep = "/")
1695632286344:rdsPath = paste(outPath, "rObjects", sep = "/")
1695632286354:# Load the Seurat H5 using the Seurat function
1695632286360:sob = LoadH5Seurat(file = paste(inPath, "setty_seurat_azimuth-classif.h5seurat", sep = "/"),
1695632286364:verbose = F) # This suppresses all verbose messages
1695632312190:# Checking Data
1695632312193:DimPlot(sob, group.by = "predicted.celltype.l1", reduction = "tsne") +
1695632312196:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695632312199:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695632312618:# Subset the dataset for HSPCs
1695632312622:sob.sub = subset(sob, subset = predicted.celltype.l1 == "HSPC")
1695632313826:# Print to console
1695632313829:print(sob.sub)
1695632313905:# Plotting the number of each cell type
1695632313909:sob.sub@meta.data %>%
1695632313912:group_by(predicted.celltype.l2) %>%
1695632313916:summarise(count = n()) %>%
1695632313919:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695632313922:geom_bar(stat="identity") + theme_minimal() +
1695632313926:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695632313929:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695632314624:# Subset the dataset based on specific cell types
1695632314628:sob.sub.1 = subset(sob.sub, subset = predicted.celltype.l2 %in% c("CLP", "Early Eryth", "EMP",
1695632314631:"GMP", "HSC", "LMPP"))
1695632315741:# Generate a bar plot of the selected cell types
1695632315745:bar_p = sob.sub.1@meta.data %>%
1695632315748:group_by(predicted.celltype.l2) %>%
1695632315750:summarise(count = n()) %>%
1695632315753:ggplot(aes(x=predicted.celltype.l2, y=count, fill=predicted.celltype.l2)) +
1695632315756:geom_bar(stat="identity") + theme_minimal() + scale_fill_brewer(palette = "Set1") +
1695632315759:theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1)) +
1695632315761:geom_hline(yintercept = 100, linetype = "dashed", color = "blue")
1695632315947:# tSNE plot of the subsetted cells
1695632315950:tsne_sub = DimPlot(sob.sub.1, group.by = "predicted.celltype.l2", reduction = "tsne") +
1695632315953:ggtitle(label = "Bone Marrow Cells", subtitle = "Annotated by Azimuth") +
1695632315956:xlab("tSNE 1") + ylab("tSNE 2") + scale_color_brewer(palette = "Set1")
1695632316037:# Combine and display the tSNE and bar plots
1695632316041:ggarrange(tsne_sub, bar_p)
1695632316984:# Extracting the Raw counts
1695632316988:rawCounts = sob.sub.1@assays$RNA@counts
1695632316996:# Displaying a subset of the data for inspection
1695632317000:datatable(as.data.frame(rawCounts[c(1:20),c(1:20)]),
1695632317004:options = list(scrollX = TRUE,
1695632317008:scroller = TRUE))
1695632317079:# Extracting the cell metadata
1695632317083:cellMetaData = sob.sub.1@meta.data
1695632317097:# Appending descriptive names for the cell types
1695632317101:cellMetaData[cellMetaData$predicted.celltype.l2 == "HSC", "Cell.type"] = "Hematopoietic Stem Cells (HSCs)"
1695632317127:cellMetaData[cellMetaData$predicted.celltype.l2 == "CLP", "Cell.type"] = "Common Lymphoid Progenitor (CLPs)"
1695632317144:cellMetaData[cellMetaData$predicted.celltype.l2 == "Early Eryth", "Cell.type"] = "Primitive Erythrocytes (PEs)"
1695632317160:cellMetaData[cellMetaData$predicted.celltype.l2 == "EMP", "Cell.type"] = "Erythro-Myeloid Progenitors (EMPs)"
1695632317174:cellMetaData[cellMetaData$predicted.celltype.l2 == "GMP", "Cell.type"] = "Granulocyte-Monocyte Progenitor (GMPs)"
1695632317192:cellMetaData[cellMetaData$predicted.celltype.l2 == "LMPP", "Cell.type"] = "Lympho-Myeloid Primed Progenitor Cell (LMPPs)"
1695632317210:# Displaying a subset of the metadata for inspection
1695632317214:datatable(cellMetaData, options = list(scrollX = TRUE,
1695632317217:scroller = TRUE))
1695632317361:# Extracting the gene-level metadata
1695632317365:geneMetaData = sob.sub.1@assays$RNA@meta.features
1695632317371:# Displaying a subset of the gene metadata for inspection
1695632317374:datatable(geneMetaData, options = list(scrollX = TRUE,
1695632317377:scroller = TRUE))
1695632317793:# Assigning row names to the gene_short_name column
1695632317797:geneMetaData$gene_short_name = rownames(geneMetaData)
1695632317806:# Displaying the updated gene metadata for verification
1695632317810:datatable(geneMetaData, options = list(scrollX = TRUE,
1695632317814:scroller = TRUE))
1695632318257:# Generating the CDS using Monocle3's built-in function
1695632318260:cds = new_cell_data_set(expression_data = rawCounts,
1695632318265:cell_metadata = cellMetaData,
1695632318268:gene_metadata = geneMetaData)
1695632318779:# Displaying the newly created CDS
1695632318784:cds
1695632318937:# Monocle 3 allows do this pre-processing in 1 go
1695632318943:cds = preprocess_cds(cds = cds,
1695632318948:method = "PCA",
1695632318952:num_dim = 50,
1695632318955:norm_method = "log",
1695632318958:pseudo_count = 1,
1695632318962:scaling = T,
1695632318965:verbose = F)
1695632343937:# Monocle 3 allows do this to do pre-processing in 1 go
1695632343941:cds = reduce_dimension(cds = cds,
1695632343944:max_components = 3,
1695632343946:reduction_method = "UMAP",
1695632343949:preprocess_method = "PCA",
1695632343951:umap.min_dist = 0.2,
1695632343954:umap.n_neighbors = 15)
1695632351263:# We have other options as well
1695632351266:cds_tsne = reduce_dimension(cds = cds,
1695632351269:max_components = 3,
1695632351271:reduction_method = "tSNE",
1695632351274:preprocess_method = "PCA",
1695632351277:umap.min_dist = 0.2,
1695632351279:umap.n_neighbors = 15)
1695632367690:# We have other options as well
1695632367693:cds_PCA = reduce_dimension(cds = cds,
1695632367696:max_components = 3,
1695632367699:reduction_method = "PCA",
1695632367701:preprocess_method = "PCA",
1695632367704:umap.min_dist = 0.2,
1695632367707:umap.n_neighbors = 15)
1695632367868:# 2D plot PCA
1695632367871:cds_PCA_plot = plot_cells(cds = cds_PCA, reduction_method = "PCA",
1695632367874:color_cells_by = "Cell.type",alpha = 0.7,
1695632367877:show_trajectory_graph = F, # We will explore this later
1695632367879:label_cell_groups = F, # This is to hide labels on the map
1695632367882:cell_size = 1.4) + theme(legend.position = "bottom") +
1695632367885:scale_color_brewer(palette = "Set1")
1695632368127:# 2D plot tSNE
1695632368130:cds_tSNE_plot = plot_cells(cds = cds_tsne, reduction_method = "tSNE",
1695632368133:color_cells_by = "Cell.type",alpha = 0.7,
1695632368136:show_trajectory_graph = F, # We will explore this later
1695632368139:label_cell_groups = F, # This is to hide labels on the map
1695632368143:cell_size = 1.4) + theme(legend.position = "bottom") +
1695632368146:scale_color_brewer(palette = "Set1")
1695632368378:# Plot
1695632368381:ggarrange(cds_tSNE_plot, cds_PCA_plot)
1695632369277:# 2D plot
1695632369282:plot_cells(cds = cds,
1695632369286:color_cells_by = "Cell.type",alpha = 0.7,
1695632369290:show_trajectory_graph = F, # We will explore this later
1695632369293:label_cell_groups = F, # This is to hide labels on the map
1695632369296:cell_size = 1.4) + theme(legend.position = "bottom") +
1695632369299:scale_color_brewer(palette = "Set1")
1695632369908:# 3d Plot
1695632369915:plot_cells_3d(cds = cds,
1695632369920:color_cells_by = "Cell.type",
1695632369923:show_trajectory_graph = F, # We will explore this later
1695632369928:cell_size = 10)
1695632370497:# Monocle 3 allows do this to do pre-processing in 1 go
1695632370500:cds = reduce_dimension(cds = cds,
1695632370503:max_components = 2,
1695632370506:reduction_method = "UMAP",
1695632370509:preprocess_method = "PCA",
1695632370512:umap.min_dist = 0.2,
1695632370514:umap.n_neighbors = 15)
1695632378089:# 2D plot
1695632378091:plot_cells(cds = cds,
1695632378094:color_cells_by = "Cell.type",alpha = 0.7,
1695632378096:show_trajectory_graph = F, # We will explore this later
1695632378100:label_cell_groups = F, # This is to hide labels on the map
1695632378104:cell_size = 1.4) + theme(legend.position = "bottom") +
1695632378109:scale_color_brewer(palette = "Set1")
1695632378923:cds <- cluster_cells(cds = cds,
1695632378927:reduction_method = "UMAP",
1695632378931:cluster_method = "leiden",
1695632378934:resolution = 0.01,
1695632378938:k = 25)
1695632382272:cds_louvain <- cluster_cells(cds = cds,
1695632382275:k = 25,
1695632382278:resolution = 0.01,
1695632382280:reduction_method = "UMAP",
1695632382283:cluster_method = "louvain")
1695632385457:# Lieden Clusters
1695632385460:lieden_Cluster <- plot_cells(cds = cds,
1695632385463:color_cells_by = "cluster",alpha = 0.7,
1695632385466:show_trajectory_graph = F, # We will explore this later
1695632385468:label_cell_groups = F, # This is to hide labels on the map
1695632385471:cell_size = 1.4) + theme(legend.position = "bottom") +
1695632385474:scale_color_brewer(palette = "Set3")
1695632385675:# louvain Clusters
1695632385677:louvain_Cluster <- plot_cells(cds = cds_louvain,
1695632385680:color_cells_by = "cluster",alpha = 0.7,
1695632385682:show_trajectory_graph = F, # We will explore this later
1695632385685:label_cell_groups = F, # This is to hide labels on the map
1695632385688:cell_size = 1.4) + theme(legend.position = "bottom") +
1695632385690:scale_color_brewer(palette = "Set1")
1695632385893:# Cell Types
1695632385896:cell_type_plots <- plot_cells(cds = cds,
1695632385899:color_cells_by = "Cell.type",alpha = 0.7,
1695632385902:show_trajectory_graph = F, # We will explore this later
1695632385904:label_cell_groups = F, # This is to hide labels on the map
1695632385907:cell_size = 1.4) + theme(legend.position = "right") +
1695632385910:scale_color_brewer(palette = "Set1")
1695632386109:# Plot lieden_Cluster
1695632386112:lieden_Cluster + cell_type_plots
1695632386764:# Plot louvain_Cluster
1695632386772:louvain_Cluster + cell_type_plots
1695632387901:# Set colour label as partition
1695632387904:partition_plots <- plot_cells(cds = cds,
1695632387907:color_cells_by = "partition",alpha = 0.7,
1695632387910:show_trajectory_graph = F, # We will explore this later
1695632387912:label_cell_groups = F, # This is to hide labels on the map
1695632387915:cell_size = 1.4) + theme(legend.position = "right") +
1695632387917:scale_color_brewer(palette = "Set1")
1695632388122:# Plot Partitions
1695632388124:partition_plots
1695632388494:cds <- learn_graph(cds = cds,
1695632388497:use_partition = F, # We will see it later
1695632388499:close_loop = F)  # We will see it later
1695632396397:# Set show_trajectory_graph as true
1695632396400:trajectory_plots <- plot_cells(cds = cds,
1695632396403:color_cells_by = "partition",alpha = 0.7,
1695632396405:show_trajectory_graph = T, # We will explore this later
1695632396408:label_cell_groups = F, # This is to hide labels on the map
1695632396410:cell_size = 0.1) +
1695632396413:scale_color_brewer(palette = "Set1")
1695632396770:# Label principal Points
1695632396773:ppoints_plots <- plot_cells(cds = cds,
1695632396775:label_branch_points = T,
1695632396779:label_principal_points = T,
1695632396781:color_cells_by = "partition",alpha = 0.7,
1695632396785:show_trajectory_graph = T, # We will explore this later
1695632396788:label_cell_groups = F, # This is to hide labels on the map
1695632396791:cell_size = 0.1) +
1695632396793:scale_color_brewer(palette = "Set1")
1695632397071:# Set show_trajectory_graph as true
1695632397074:trajectory_cellType_plots <- plot_cells(cds = cds,
1695632397076:color_cells_by = "Cell.type",alpha = 0.7,
1695632397079:label_principal_points = F,
1695632397082:show_trajectory_graph = T, # We will explore this later
1695632397085:label_cell_groups = T, graph_label_size = 0.1,
1695632397089:cell_size = 0.5) +
1695632397091:scale_color_brewer(palette = "Set3")
1695632397488:# Plot all together
1695632397491:ggarrange(trajectory_plots, ppoints_plots, lieden_Cluster, trajectory_cellType_plots,
1695632397495:ncol = 2, nrow = 2, labels = c("A. Trajectory Graph", "B. Principal Points",
1695632397497:"C. Lieden Clusters", "D. Cell Types with Trajectory Graph"))
1695632476292:# The following command launches the shinyApp
1695632476297:cds_shiny <- order_cells(cds = cds, reduction_method = "UMAP")
1695632760200:# Set show_trajectory_graph as true
1695632760207:marked_start_cells <- plot_cells(cds = cds,
1695632760211:color_cells_by = "grey",alpha = 0.7,
1695632760214:label_principal_points = F,
1695632760217:show_trajectory_graph = T, # We will explore this later
1695632760220:label_cell_groups = T, graph_label_size = 0.1,
1695632760223:cell_size = 0.5) +
1695632760226:scale_color_brewer(palette = "Set3")
1695632769270:# Set show_trajectory_graph as true
1695632769273:marked_start_cells <- plot_cells(cds = cds,
1695632769276:color_cells_by = "partition",alpha = 0.7,
1695632769279:label_principal_points = F,
1695632769283:show_trajectory_graph = T, # We will explore this later
1695632769286:label_cell_groups = T, graph_label_size = 0.1,
1695632769289:cell_size = 0.5) +
1695632769292:scale_color_brewer(palette = "Set3")
1695632775937:# Set show_trajectory_graph as true
1695632775942:marked_start_cells <- plot_cells(cds = cds,
1695632775945:color_cells_by = "partition",alpha = 0.7,
1695632775948:label_principal_points = F,
1695632775952:show_trajectory_graph = T, # We will explore this later
1695632775956:label_cell_groups = T, graph_label_size = 0.1,
1695632775959:cell_size = 0.5) +
1695632775963:scale_color_brewer(palette = "grey")
1695632778902:marked_start_cells
1695632791445:# Set show_trajectory_graph as true
1695632791451:marked_start_cells <- plot_cells(cds = cds,
1695632791455:color_cells_by = "partition",alpha = 0.7,
1695632791458:label_principal_points = F,
1695632791461:show_trajectory_graph = T, # We will explore this later
1695632791464:label_cell_groups = T, graph_label_size = 0.1,
1695632791466:cell_size = 0.5) +
1695632791469:scale_color_manual("grey")
1695632794775:marked_start_cells
1695632803248:# Set show_trajectory_graph as true
1695632803254:marked_start_cells <- plot_cells(cds = cds,
1695632803259:color_cells_by = "partition",alpha = 0.7,
1695632803262:label_principal_points = F,
1695632803265:show_trajectory_graph = T, # We will explore this later
1695632803268:label_cell_groups = T, graph_label_size = 0.1,
1695632803271:cell_size = 0.5)
1695632806332:marked_start_cells
1695632815759:# Set show_trajectory_graph as true
1695632815765:marked_start_cells <- plot_cells(cds = cds,
1695632815770:color_cells_by = "partition",alpha = 0.7,
1695632815773:label_principal_points = F,
1695632815777:show_trajectory_graph = T, # We will explore this later
1695632815781:label_cell_groups = T, graph_label_size = 0.1,
1695632815784:cell_size = 0.5) + geom_point("grey")
1695632820168:marked_start_cells
1695632841092:# Set show_trajectory_graph as true
1695632841098:marked_start_cells <- plot_cells(cds = cds,
1695632841104:color_cells_by = "partition",alpha = 0.7,
1695632841107:label_principal_points = F,
1695632841110:show_trajectory_graph = T, # We will explore this later
1695632841113:label_cell_groups = T, graph_label_size = 0.1,
1695632841117:cell_size = 0.5) + scale_color_discrete("grey")
1695632844026:marked_start_cells
1695632851583:# Set show_trajectory_graph as true
1695632851589:marked_start_cells <- plot_cells(cds = cds,
1695632851592:color_cells_by = "partition",alpha = 0.7,
1695632851596:label_principal_points = F,
1695632851599:show_trajectory_graph = T, # We will explore this later
1695632851603:label_cell_groups = T, graph_label_size = 0.1,
1695632851606:cell_size = 0.5) + scale_color_manual("grey")
1695632854458:marked_start_cells
1695632862907:# Set show_trajectory_graph as true
1695632862912:marked_start_cells <- plot_cells(cds = cds,
1695632862915:color_cells_by = "partition",alpha = 0.7,
1695632862918:label_principal_points = F,
1695632862922:show_trajectory_graph = T, # We will explore this later
1695632862925:label_cell_groups = T, graph_label_size = 0.1,
1695632862929:cell_size = 0.5) + scale_color_brewer("grey")
1695632865482:marked_start_cells
1695632976697:dim(cellMetaData)
1695632981150:cds
1695633086352:# Extract the Start cells
1695633086356:markers <- ifelse(cellMetaData$Cell.type == "Hematopoietic Stem Cells (HSCs)", "#f48b53", "grey")
1695633088609:markers
1695633102538:# Set show_trajectory_graph as true
1695633102543:marked_start_cells <- plot_cells(cds = cds,
1695633102546:color_cells_by = "partition",alpha = 0.7,
1695633102548:label_principal_points = F,
1695633102551:show_trajectory_graph = T, # We will explore this later
1695633102553:label_cell_groups = T, graph_label_size = 0.1,
1695633102556:cell_size = 0.5) + geom_point(aes(color = markers))
1695633105614:marked_start_cells
1695633120481:# Set show_trajectory_graph as true
1695633120487:marked_start_cells <- plot_cells(cds = cds,
1695633120490:color_cells_by = "partition",alpha = 0.7,
1695633120493:label_principal_points = F,
1695633120496:show_trajectory_graph = T, # We will explore this later
1695633120499:label_cell_groups = T, graph_label_size = 0.1,
1695633120502:cell_size = 0.5) + geom_point(aes(color = markers)) +  scale_color_identity()
1695633123127:marked_start_cells
1695633195059:+  scale_color_identity() + theme(legend.position = "bottom")
1695633215402:# Set show_trajectory_graph as true
1695633215407:marked_start_cells <- plot_cells(cds = cds,
1695633226010:)
1695633239445:# Set show_trajectory_graph as true
1695633239451:marked_start_cells <- plot_cells(cds = cds,
1695633239454:color_cells_by = "partition",alpha = 0.7,
1695633239456:label_principal_points = F,
1695633239459:show_trajectory_graph = T, # We will explore this later
1695633239461:label_cell_groups = T, graph_label_size = 0.1,
1695633239464:cell_size = 0.5) +
1695633239467:geom_point(aes(color = markers)) +
1695633239469:scale_color_identity() +
1695633239472:theme(legend.position = "bottom")
1695633242053:marked_start_cells
1695633361422:# Set show_trajectory_graph as true
1695633361427:marked_start_cells <- plot_cells(cds = cds,
1695633361429:color_cells_by = "partition",alpha = 0.7,
1695633361432:label_principal_points = F,
1695633361435:show_trajectory_graph = T, # We will explore this later
1695633361437:label_cell_groups = T, graph_label_size = 0.1,
1695633361440:cell_size = 0.5) +
1695633361443:geom_point(aes(color = markers)) +
1695633361446:scale_color_manual(values = c("Hematopoietic Stem Cells (HSCs)" = "#f48b53", "Lineage Comitted Cells" = "grey"),
1695633361449:labels = c("Marked" = "Hematopoietic Stem Cells (HSCs)",
1695633361498:"Unmarked" = "Lineage Committed Cells"))
1695633364377:# Extract the Start cells #f48b53
1695633364381:markers <- ifelse(cellMetaData$Cell.type == "Hematopoietic Stem Cells (HSCs)", "Marked", "Unmarked")
1695633364848:# Set show_trajectory_graph as true
1695633364851:marked_start_cells <- plot_cells(cds = cds,
1695633364855:color_cells_by = "partition",alpha = 0.7,
1695633364858:label_principal_points = F,
1695633364860:show_trajectory_graph = T, # We will explore this later
1695633364863:label_cell_groups = T, graph_label_size = 0.1,
1695633364866:cell_size = 0.5) +
1695633364869:geom_point(aes(color = markers)) +
1695633364872:scale_color_manual(values = c("Hematopoietic Stem Cells (HSCs)" = "#f48b53", "Lineage Comitted Cells" = "grey"),
1695633364874:labels = c("Marked" = "Hematopoietic Stem Cells (HSCs)",
1695633364877:"Unmarked" = "Lineage Committed Cells"))
1695633368051:marked_start_cells
1695633403839:# Set show_trajectory_graph as true
1695633403845:marked_start_cells <- plot_cells(cds = cds,
1695633403848:color_cells_by = "partition",alpha = 0.7,
1695633403850:label_principal_points = F,
1695633403853:show_trajectory_graph = T, # We will explore this later
1695633403856:label_cell_groups = T, graph_label_size = 0.1,
1695633403860:cell_size = 0.5) +
1695633403863:geom_point(aes(color = markers)) +
1695633403865:scale_color_manual(values = c("Marked" = "#f48b53", "Unmarked" = "grey"),
1695633403868:labels = c("Marked" = "Hematopoietic Stem Cells (HSCs)",
1695633403870:"Unmarked" = "Lineage Committed Cells"))
1695633406908:marked_start_cells
1695633457294:# Set show_trajectory_graph as true
1695633457300:marked_start_cells <- plot_cells(cds = cds,
1695633457303:color_cells_by = "partition",alpha = 0.7,
1695633457307:label_principal_points = F,
1695633457310:show_trajectory_graph = T, # We will explore this later
1695633457313:label_cell_groups = T, graph_label_size = 0.1,
1695633457316:cell_size = 0.5) +
1695633457319:geom_point(aes(color = markers)) +
1695633457322:scale_color_manual(name = "Cell Type", values = c("Marked" = "#f48b53", "Unmarked" = "grey"),
1695633457324:labels = c("Marked" = "Hematopoietic Stem Cells (HSCs)",
1695633457327:"Unmarked" = "Lineage Committed Cells")) +
1695633457330:guides(color=guide_legend(title="Cell Type")) +
1695633457332:labs(color="Cell Type")
1695633460468:marked_start_cells
1695633485599:# Set show_trajectory_graph as true
1695633485603:marked_start_cells <- plot_cells(cds = cds,
1695633485606:color_cells_by = "partition",alpha = 0.7,
1695633485608:label_principal_points = F,
1695633485611:show_trajectory_graph = T, # We will explore this later
1695633485613:label_cell_groups = T, graph_label_size = 0.1,
1695633485617:cell_size = 0.5) +
1695633485619:geom_point(aes(color = markers)) +
1695633485622:scale_color_identity() +
1695633485625:theme(legend.position = "bottom")
1695633488058:marked_start_cells
1695633496584:# Extract the Start cells
1695633496588:markers <- ifelse(cellMetaData$Cell.type == "Hematopoietic Stem Cells (HSCs)", "#f48b53", "grey")
1695633496937:# Set show_trajectory_graph as true
1695633496940:marked_start_cells <- plot_cells(cds = cds,
1695633496943:color_cells_by = "partition",alpha = 0.7,
1695633496947:label_principal_points = F,
1695633496949:show_trajectory_graph = T, # We will explore this later
1695633496952:label_cell_groups = T, graph_label_size = 0.1,
1695633496954:cell_size = 0.5) +
1695633496957:geom_point(aes(color = markers)) +
1695633496960:scale_color_identity() +
1695633496962:theme(legend.position = "bottom")
1695633500350:marked_start_cells
1695633636793:# Set show_trajectory_graph as true
1695633636799:marked_start_cells_pp <- plot_cells(cds = cds,
1695633636803:color_cells_by = "partition",alpha = 0.7,
1695633636806:label_principal_points = T,
1695633636809:show_trajectory_graph = T, # We will explore this later
1695633636811:label_cell_groups = T, graph_label_size = 0.1,
1695633636814:cell_size = 0.5) +
1695633636817:geom_point(aes(color = markers)) +
1695633636820:scale_color_identity() +
1695633636822:theme(legend.position = "bottom")
1695633640272:marked_start_cells_pp
1695633645785:# Set show_trajectory_graph as true
1695633645791:marked_start_cells_pp <- plot_cells(cds = cds,
1695633645794:color_cells_by = "partition",alpha = 0.7,
1695633645796:label_principal_points = T,
1695633645799:show_trajectory_graph = T, # We will explore this later
1695633645802:label_cell_groups = T, graph_label_size = 0.1,
1695633645805:cell_size = 0.5) +
1695633645808:geom_point(aes(color = markers)) +
1695633645810:scale_color_identity() +
1695633645813:theme(legend.position = "bottom")
1695633648776:marked_start_cells_pp
1695633655050:# Set show_trajectory_graph as true
1695633655053:marked_start_cells_pp <- plot_cells(cds = cds,
1695633655056:color_cells_by = "partition",alpha = 0.7,
1695633655060:label_principal_points = T,
1695633655062:show_trajectory_graph = T, # We will explore this later
1695633655065:label_cell_groups = T, graph_label_size = 0.1,
1695633655067:cell_size = 0.5)
1695633658688:marked_start_cells_pp
1695633698182:# Set show_trajectory_graph as true
1695633698188:marked_ppoints_plots <- plot_cells(cds = cds,
1695633698191:label_branch_points = T,
1695633698194:label_principal_points = T,
1695633698196:color_cells_by = "partition",alpha = 0.7,
1695633698199:show_trajectory_graph = T, # We will explore this later
1695633698201:label_cell_groups = F, # This is to hide labels on the map
1695633698204:cell_size = 0.1) +
1695633698207:scale_color_brewer(palette = "Set1")
1695633700499:marked_ppoints_plots
1695633710565:# Set show_trajectory_graph as true
1695633710575:marked_ppoints_plots <- plot_cells(cds = cds,
1695633710580:label_branch_points = T,
1695633710583:label_principal_points = T,
1695633710586:color_cells_by = "partition",alpha = 0.7,
1695633710588:show_trajectory_graph = T, # We will explore this later
1695633710591:label_cell_groups = F, # This is to hide labels on the map
1695633710594:cell_size = 0.5) +
1695633710596:scale_color_brewer(palette = "Set1")
1695633718848:# Set show_trajectory_graph as true
1695633718852:marked_ppoints_plots <- plot_cells(cds = cds,
1695633718856:label_branch_points = T,
1695633718859:label_principal_points = T,
1695633718861:color_cells_by = "partition",alpha = 0.7,
1695633718864:show_trajectory_graph = T, # We will explore this later
1695633718867:label_cell_groups = F, # This is to hide labels on the map
1695633718869:cell_size = 0.5) +
1695633718872:scale_color_brewer(palette = "Set1")
1695633719143:marked_ppoints_plots
1695633743941:# Set show_trajectory_graph as true
1695633743947:marked_ppoints_plots <- plot_cells(cds = cds,
1695633743951:label_branch_points = T,
1695633743955:label_principal_points = T,
1695633743959:color_cells_by = "partition",alpha = 0.7,
1695633743963:show_trajectory_graph = T, # We will explore this later
1695633743966:label_cell_groups = F, # This is to hide labels on the map
1695633743969:cell_size = 0.5) +  geom_point(aes(color = markers)) +
1695633743971:scale_color_identity() +
1695633743975:theme(legend.position = "bottom")
1695633744831:marked_ppoints_plots
1695633768709:# Set show_trajectory_graph as true
1695633768715:marked_ppoints_plots <- plot_cells(cds = cds,
1695633768718:label_branch_points = T,
1695633768720:label_principal_points = T,
1695633768723:color_cells_by = "partition",alpha = 0.7,
1695633768725:show_trajectory_graph = T, # We will explore this later
1695633768728:label_cell_groups = F, # This is to hide labels on the map
1695633768731:cell_size = 0.5) +  geom_point(aes(color = markers, alpha = 0.2)) +
1695633768733:scale_color_identity() +
1695633768736:theme(legend.position = "bottom")
1695633769510:marked_ppoints_plots
1695633784332:# Set show_trajectory_graph as true
1695633784337:marked_ppoints_plots <- plot_cells(cds = cds,
1695633784340:cell_stroke = 0.1,
1695633784343:label_branch_points = T,
1695633784345:label_principal_points = T,
1695633784348:color_cells_by = "partition",alpha = 0.7,
1695633784351:show_trajectory_graph = T, # We will explore this later
1695633784354:label_cell_groups = F, # This is to hide labels on the map
1695633784356:cell_size = 0.5) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633784359:scale_color_identity() +
1695633784362:theme(legend.position = "bottom")
1695633785122:marked_ppoints_plots
1695633799819:# Set show_trajectory_graph as true
1695633799825:marked_ppoints_plots <- plot_cells(cds = cds,
1695633799828:cell_stroke = 0.5,
1695633799835:label_branch_points = T,
1695633799839:label_principal_points = T,
1695633799841:color_cells_by = "partition",alpha = 0.7,
1695633799845:show_trajectory_graph = T, # We will explore this later
1695633799848:label_cell_groups = F, # This is to hide labels on the map
1695633799850:cell_size = 0.5) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633799853:scale_color_identity() +
1695633799855:theme(legend.position = "bottom")
1695633800667:marked_ppoints_plots
1695633806458:# Set show_trajectory_graph as true
1695633806466:marked_ppoints_plots <- plot_cells(cds = cds,
1695633806470:cell_stroke = 0.5,
1695633806476:label_branch_points = T,
1695633806479:label_principal_points = T,
1695633806482:color_cells_by = "partition",alpha = 0.7,
1695633806484:show_trajectory_graph = T, # We will explore this later
1695633806487:label_cell_groups = F, # This is to hide labels on the map
1695633806490:cell_size = 0.2) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633806492:scale_color_identity() +
1695633806495:theme(legend.position = "bottom")
1695633809055:marked_ppoints_plots
1695633815135:# Set show_trajectory_graph as true
1695633815139:marked_ppoints_plots <- plot_cells(cds = cds,
1695633815142:cell_stroke = 0.1,
1695633815148:label_branch_points = T,
1695633815151:label_principal_points = T,
1695633815153:color_cells_by = "partition",alpha = 0.7,
1695633815156:show_trajectory_graph = T, # We will explore this later
1695633815159:label_cell_groups = F, # This is to hide labels on the map
1695633815162:cell_size = 0.2) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633815165:scale_color_identity() +
1695633815168:theme(legend.position = "bottom")
1695633816051:marked_ppoints_plots
1695633824622:marked_ppoints_plots
1695633849708:# Set show_trajectory_graph as true
1695633849712:marked_ppoints_plots <- plot_cells(cds = cds,
1695633849715:cell_stroke = 0,
1695633849717:label_branch_points = T,
1695633849720:label_principal_points = T,
1695633849723:color_cells_by = "partition",alpha = 0.7,
1695633849726:show_trajectory_graph = T, # We will explore this later
1695633849729:label_cell_groups = F, # This is to hide labels on the map
1695633849731:cell_size = 0.2) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633849734:scale_color_identity() +
1695633849737:theme(legend.position = "bottom")
1695633851244:marked_ppoints_plots
1695633855251:marked_ppoints_plots
1695633860317:# Set show_trajectory_graph as true
1695633860322:marked_ppoints_plots <- plot_cells(cds = cds,
1695633860325:label_branch_points = T,
1695633860327:label_principal_points = T,
1695633860330:color_cells_by = "partition",alpha = 0.7,
1695633860333:show_trajectory_graph = T, # We will explore this later
1695633860336:label_cell_groups = F, # This is to hide labels on the map
1695633860338:cell_size = 0.2) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633860341:scale_color_identity() +
1695633860344:theme(legend.position = "bottom")
1695633863312:marked_ppoints_plots
1695633865980:marked_ppoints_plots
1695633882262:# Extract the Start cells
1695633882269:markers <- ifelse(cellMetaData$Cell.type == "Hematopoietic Stem Cells (HSCs)", "#f48b53", "lightgrey")
1695633882907:# Set show_trajectory_graph as true
1695633882913:marked_start_cells <- plot_cells(cds = cds,
1695633882916:color_cells_by = "partition",alpha = 0.7,
1695633882918:label_principal_points = F,
1695633882921:show_trajectory_graph = T, # We will explore this later
1695633882924:label_cell_groups = T, graph_label_size = 0.1,
1695633882927:cell_size = 0.5) +
1695633882929:geom_point(aes(color = markers)) +
1695633882932:scale_color_identity() +
1695633882935:theme(legend.position = "bottom")
1695633887805:marked_start_cells
1695633893047:# Set show_trajectory_graph as true
1695633893052:marked_ppoints_plots <- plot_cells(cds = cds,
1695633893055:label_branch_points = T,
1695633893058:label_principal_points = T,
1695633893061:color_cells_by = "partition",alpha = 0.7,
1695633893063:show_trajectory_graph = T, # We will explore this later
1695633893066:label_cell_groups = F, # This is to hide labels on the map
1695633893069:cell_size = 0.2) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633893071:scale_color_identity() +
1695633893074:theme(legend.position = "bottom")
1695633893865:marked_ppoints_plots
1695633900273:marked_ppoints_plots
1695633992555:# Set show_trajectory_graph as true
1695633992563:marked_ppoints_plots <- plot_cells(cds = cds,
1695633992567:label_branch_points = T,
1695633992570:label_principal_points = T,
1695633992572:color_cells_by = "partition",alpha = 0.7,
1695633992575:show_trajectory_graph = T, # We will explore this later
1695633992578:label_cell_groups = F, # This is to hide labels on the map
1695633992580:cell_size = 0.2) +  geom_point(aes(color = markers, alpha = 0.1)) +
1695633992583:scale_color_identity()
1695633993347:marked_ppoints_plots
1695633999790:marked_ppoints_plots
1695634080175:cds <- order_cells(cds, reduction_method = "UMAP",
1695634080179:root_pr_nodes = c("Y_257", "Y_177"))
1695634143509:# Set show_trajectory_graph as true
1695634143518:pseudotime_plot <- plot_cells(cds = cds,
1695634143526:label_branch_points = T,
1695634143534:label_principal_points = T,
1695634143540:color_cells_by = "pseudotime",alpha = 0.7,
1695634143545:show_trajectory_graph = T, # We will explore this later
1695634143548:label_cell_groups = F, # This is to hide labels on the map
1695634143551:cell_size = 0.2)
1695634143849:pseudotime_plot
1695634150358:# Set show_trajectory_graph as true
1695634150363:pseudotime_plot <- plot_cells(cds = cds,
1695634150366:label_branch_points = T,
1695634150368:label_principal_points = T,
1695634150371:color_cells_by = "pseudotime",alpha = 0.7,
1695634150374:show_trajectory_graph = T, # We will explore this later
1695634150377:label_cell_groups = F, # This is to hide labels on the map
1695634150380:cell_size = 1.3)
1695634153510:pseudotime_plot
1695634156354:pseudotime_plot
1695634186173:# Set show_trajectory_graph as true
1695634186177:pseudotime_plot <- plot_cells(cds = cds,
1695634186179:label_branch_points = T,
1695634186182:label_principal_points = F,
1695634186185:color_cells_by = "pseudotime",alpha = 0.7,
1695634186188:show_trajectory_graph = T, # We will explore this later
1695634186191:label_cell_groups = F, # This is to hide labels on the map
1695634186193:cell_size = 1.3)
1695634187494:pseudotime_plot
1695634204626:ggarrange(pseudotime_plot, cell_type_plots)
1695634449523:# Extract counts for CD34
1695634449530:cds_cd34 <- cds[rowData(cds)$gene_short_name == "CD34", ]
1695634452788:cds_cd34
1695634507385:# Plot _cells
1695634507389:plot_genes_in_pseudotime(cds_cd34,
1695634507392:min_expr = 0.5,
1695634507395:cell_size = 1.2,
1695634507398:color_cells_by = "Cell.type")
1695634510782:plot_genes_in_pseudotime(cds_cd34,
1695634510783:min_expr = 0.5,
1695634510783:cell_size = 1.2,
1695634510783:color_cells_by = "Cell.type")
1695634565234:# Plot _cells
1695634565242:plot_genes_in_pseudotime(cds_cd34,
1695634565246:min_expr = 0.5,
1695634565248:cell_size = 1.2,
1695634565251:color_cells_by = "Cell.type") +
1695634565254:scale_color_brewer(palette = "Set1")
1695634571139:# Plot _cells
1695634571144:plot_genes_in_pseudotime(cds_cd34,
1695634571145:min_expr = 0.5,
1695634571145:cell_size = 1.2,
1695634571146:color_cells_by = "Cell.type") +
1695634571146:scale_color_brewer(palette = "Set1")
1695634637109:# Plot UMAP
1695634637114:trend_umap <- plot_cells(cds,genes = "CD34")+
1695634637117:scale_color_brewer(palette = "Set1")
1695634639738:trend_umap
1695634647016:# Plot UMAP
1695634647021:trend_umap <- plot_cells(cds,genes = "CD34")
1695634650292:trend_umap
1695634660479:# Plot UMAP
1695634660484:trend_umap <- plot_cells(cds,genes = "CD34", cell_size = 1.4)
1695634662912:trend_umap
1695634774034:# Extract counts for CD34
1695634774042:cds_mpo <- cds[rowData(cds)$gene_short_name == "MPO", ]
1695634774847:# Plot trend
1695634774853:trend <- plot_genes_in_pseudotime(cds_mpo,
1695634774856:min_expr = 0.5,
1695634774859:cell_size = 1.2,
1695634774862:color_cells_by = "Cell.type") +
1695634774865:scale_color_brewer(palette = "Set1")
1695634777849:trend
1695634808896:# Extract counts for CD34
1695634808900:cds_mpo <- cds[rowData(cds)$gene_short_name == "MPO", ]
1695634808992:# Plot trend
1695634809004:trend_mpo <- plot_genes_in_pseudotime(cds_mpo,
1695634809008:min_expr = 0.5,
1695634809011:cell_size = 1.2,
1695634809015:color_cells_by = "Cell.type") +
1695634809019:scale_color_brewer(palette = "Set1")
1695634810266:# Plot
1695634810269:trend_mpo
1695634815291:# Plot
1695634815295:trend_mpo
1695634845821:# Extract counts for CD34
1695634845827:cds_irf8 <- cds[rowData(cds)$gene_short_name == "IRF8", ]
1695634846809:# Plot trend
1695634846813:trend_irf8 <- plot_genes_in_pseudotime(cds_mpo,
1695634846822:min_expr = 0.5,
1695634846826:cell_size = 1.2,
1695634846829:color_cells_by = "Cell.type") +
1695634846831:scale_color_brewer(palette = "Set1")
1695634850721:# Plot
1695634850725:trend_irf8
1695634858018:# Plot trend
1695634858022:trend_irf8 <- plot_genes_in_pseudotime(trend_irf8,
1695634858025:min_expr = 0.5,
1695634858027:cell_size = 1.2,
1695634858030:color_cells_by = "Cell.type") +
1695634858033:scale_color_brewer(palette = "Set1")
1695634864540:# Extract counts for CD34
1695634864544:cds_irf8 <- cds[rowData(cds)$gene_short_name == "IRF8", ]
1695634867224:cds_irf8
1695634872878:# Plot trend
1695634872883:trend_irf8 <- plot_genes_in_pseudotime(trend_irf8,
1695634872886:min_expr = 0.5,
1695634872889:cell_size = 1.2,
1695634872891:color_cells_by = "Cell.type") +
1695634872894:scale_color_brewer(palette = "Set1")
1695634880811:# Plot trend
1695634880817:trend_irf8 <- plot_genes_in_pseudotime(cds_irf8,
1695634880821:min_expr = 0.5,
1695634880825:cell_size = 1.2,
1695634880828:color_cells_by = "Cell.type") +
1695634880831:scale_color_brewer(palette = "Set1")
1695634882369:# Plot
1695634882375:trend_irf8
